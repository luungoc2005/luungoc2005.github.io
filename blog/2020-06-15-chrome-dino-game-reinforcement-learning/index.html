<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.e706d8cdbf6f3e8bfa1d.css">@import url(https://fonts.googleapis.com/css?family=Open+Sans:300,400|Roboto:300,400);.Header--header--28-mG{display:block}.Header--header__container--3a_BD{flex-grow:1;margin:0 auto;padding-left:30px;padding-right:30px;max-width:1320px}@media (min-width:420px){.Header--header__container--3a_BD{max-width:1350px}}@media (min-width:720px){.Header--header__container--3a_BD{padding-left:50px;padding-right:50px;max-width:1390px}}@media (min-width:1080px){.Header--header__container--3a_BD{padding-left:70px;padding-right:70px;max-width:1430px}}.Header--header__content--19TvH{display:flex;align-items:center;padding:30px 0}.Header--header__logo--2Pboo{text-decoration:none;color:#333}.Header--header__logoSvg--26FCt{display:block;height:16px;width:auto}@media (min-width:768px){.Header--header__logoSvg--26FCt{height:18px}}.Header--header__logo--2Pboo h1{display:block;font-weight:600;font-size:medium}@media (min-width:768px){.Header--header__logo--2Pboo h1{display:inline-block;font-size:large}}.Header--header__logo--2Pboo span{color:#666;display:none}@media (min-width:768px){.Header--header__logo--2Pboo span{display:initial;padding-left:8px}}.Header--header__navigation--3RXf6{display:flex;margin-left:auto}.HeaderLink--link--XnUti{display:flex;margin-left:40px;text-decoration:none;color:#404040;transition:opacity .2s ease-in-out}.HeaderLink--link--XnUti:first-of-type{margin-left:0}.HeaderLink--link--XnUti:hover{opacity:.5}.HeaderLink--link__icon--19vgO{position:relative;margin-right:8px}.HeaderLink--link__icon--19vgO path{fill:#404040}@media (min-width:768px){.HeaderLink--link__icon--19vgO{top:3px}}.Container--container--3QHbe{flex-grow:1;margin:0 auto;padding-left:30px;padding-right:30px;max-width:1320px}@media (min-width:420px){.Container--container--3QHbe{max-width:1350px}}@media (min-width:720px){.Container--container--3QHbe{padding-left:50px;padding-right:50px;max-width:1390px}}@media (min-width:1080px){.Container--container--3QHbe{padding-left:70px;padding-right:70px;max-width:1430px}}.Footer--footer--3N4oY{position:absolute;right:0;bottom:0;left:0}.Footer--footer__content--3FUJz{display:flex;justify-content:space-between;padding:40px 0;border-bottom:10px solid #8effbf}.Footer--footer__list--3m4JX{display:flex}.Footer--footer__item--31NlX{margin-left:30px;transition:opacity .2s ease-in-out}.Footer--footer__item--31NlX:hover{opacity:.5}:root{--grid-column-count:12;--grid-baseline:16px;--grid-baseline-calc:unitless($grid-baseline)}.GridOverlay--grid--Y4CP4{position:absolute;top:0;left:0;right:0;bottom:0;z-index:10000;overflow:hidden;pointer-events:none;transform-origin:50% 0}.GridOverlay--grid__container--3ESK_{flex-grow:1;margin:0 auto;padding-left:30px;padding-right:30px;max-width:1320px;height:100%;opacity:0;transition:opacity .2s}@media (min-width:420px){.GridOverlay--grid__container--3ESK_{max-width:1350px}}@media (min-width:720px){.GridOverlay--grid__container--3ESK_{padding-left:50px;padding-right:50px;max-width:1390px}}@media (min-width:1080px){.GridOverlay--grid__container--3ESK_{padding-left:70px;padding-right:70px;max-width:1430px}}.GridOverlay--grid--Y4CP4.GridOverlay--isVerticalVisible--3gWfJ .GridOverlay--grid__container--3ESK_{opacity:1}.GridOverlay--gridIsHorizontalIsVisible--phM4F{background:linear-gradient(180deg,transparent calc(100% - 1/var(--grid-baseline-calc)*100%),rgba(0,0,0,.05) calc(100% - 1/var(--grid-baseline-calc)*100%)),linear-gradient(180deg,transparent calc(100% - 1/var(--grid-baseline-calc)*100%),hsla(0,0%,100%,.15) calc(100% - 1/var(--grid-baseline-calc)*100%));background-size:var(--grid-baseline) var(--grid-baseline)}.GridOverlay--grid__row--3VSkB{display:flex;flex-wrap:wrap;align-items:stretch;justify-content:flex-start;margin-left:-15px;margin-right:-15px;flex-direction:row;height:100%}.GridOverlay--grid__column--35GfS{flex:none;align-self:stretch;padding-left:15px;padding-right:15px;width:calc(100%/var(--grid-column-count, 12));position:relative;height:100%}.GridOverlay--grid__visualize--1dqGC{position:relative;width:100%;height:100%}.GridOverlay--grid__visualize--1dqGC:after,.GridOverlay--grid__visualize--1dqGC:before{content:"";display:block;width:100%;height:100%;background-color:hsla(0,0%,100%,.1)}.GridOverlay--grid__visualize--1dqGC:after{position:absolute;top:0;left:0;background-color:rgba(0,0,0,.05)}.GridOverlay--grid__button--3iH5z{position:fixed;right:75px;top:0;z-index:10000;padding:0 15px;height:26px;border:1px solid rgba(0,0,0,.1);border-top:0 solid rgba(0,0,0,.1);border-radius:0 0 2px 2px;cursor:pointer;pointer-events:all;font-size:12px;text-transform:uppercase;color:#999;background-color:#fff;opacity:1;transition:opacity .25s,transform .1s}.GridOverlay--grid__button--3iH5z:hover{color:#000}.GridOverlay--grid__button--3iH5z:hover g{fill:#000}.GridOverlay--grid__button--3iH5z:first-of-type{right:131px}.GridOverlay--grid__button__svg--3azhJ{margin-top:4px}.GridOverlay--grid__button__svg--3azhJ g{fill:#8d8d8d}.GridOverlay--grid__button--3iH5z.GridOverlay--horizontal--2KwNT:hover g,.GridOverlay--grid__button--3iH5z.GridOverlay--horizontal--2KwNT g,.GridOverlay--grid__button--3iH5z.GridOverlay--vertical--G5_0K:hover g,.GridOverlay--grid__button--3iH5z.GridOverlay--vertical--G5_0K g{fill:#328bf3}[data-columns="1"] .GridOverlay--grid__column--35GfS{min-width:100%}[data-columns="2"] .GridOverlay--grid__column--35GfS{min-width:50%}[data-columns="3"] .GridOverlay--grid__column--35GfS{min-width:33.33333%}[data-columns="4"] .GridOverlay--grid__column--35GfS{min-width:25%}[data-columns="5"] .GridOverlay--grid__column--35GfS{min-width:20%}[data-columns="6"] .GridOverlay--grid__column--35GfS{min-width:16.66667%}[data-columns="7"] .GridOverlay--grid__column--35GfS{min-width:14.28571%}[data-columns="8"] .GridOverlay--grid__column--35GfS{min-width:12.5%}[data-columns="9"] .GridOverlay--grid__column--35GfS{min-width:11.11111%}[data-columns="10"] .GridOverlay--grid__column--35GfS{min-width:10%}[data-columns="11"] .GridOverlay--grid__column--35GfS{min-width:9.09091%}[data-columns="12"] .GridOverlay--grid__column--35GfS{min-width:8.33333%}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,hr,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;font-family:inherit;font-style:inherit;font-size:inherit;font-weight:inherit;border:0;border-radius:0}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}table{border-collapse:collapse;border-spacing:0}button,input,select,textarea{font-family:inherit;font-style:inherit;font-size:inherit;font-weight:inherit;border:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}button:focus:not(:focus-visible),input:focus:not(:focus-visible),select:focus:not(:focus-visible),textarea:focus:not(:focus-visible){outline:none}.container,.container-fluid{margin-right:auto;margin-left:auto}.container-fluid{padding-right:2rem;padding-left:2rem}.row{box-sizing:border-box;display:flex;flex:0 1 auto;flex-direction:row;flex-wrap:wrap;margin-right:-.5rem;margin-left:-.5rem}.row.reverse{flex-direction:row-reverse}.col.reverse{flex-direction:column-reverse}.col-xs,.col-xs-1,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-offset-0,.col-xs-offset-1,.col-xs-offset-2,.col-xs-offset-3,.col-xs-offset-4,.col-xs-offset-5,.col-xs-offset-6,.col-xs-offset-7,.col-xs-offset-8,.col-xs-offset-9,.col-xs-offset-10,.col-xs-offset-11,.col-xs-offset-12{box-sizing:border-box;flex:0 0 auto;padding-right:.5rem;padding-left:.5rem}.col-xs{flex-grow:1;flex-basis:0;max-width:100%}.col-xs-1{flex-basis:8.33333333%;max-width:8.33333333%}.col-xs-2{flex-basis:16.66666667%;max-width:16.66666667%}.col-xs-3{flex-basis:25%;max-width:25%}.col-xs-4{flex-basis:33.33333333%;max-width:33.33333333%}.col-xs-5{flex-basis:41.66666667%;max-width:41.66666667%}.col-xs-6{flex-basis:50%;max-width:50%}.col-xs-7{flex-basis:58.33333333%;max-width:58.33333333%}.col-xs-8{flex-basis:66.66666667%;max-width:66.66666667%}.col-xs-9{flex-basis:75%;max-width:75%}.col-xs-10{flex-basis:83.33333333%;max-width:83.33333333%}.col-xs-11{flex-basis:91.66666667%;max-width:91.66666667%}.col-xs-12{flex-basis:100%;max-width:100%}.col-xs-offset-0{margin-left:0}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-11{margin-left:91.66666667%}.start-xs{justify-content:flex-start;text-align:start}.center-xs{justify-content:center;text-align:center}.end-xs{justify-content:flex-end;text-align:end}.top-xs{align-items:flex-start}.middle-xs{align-items:center}.bottom-xs{align-items:flex-end}.around-xs{justify-content:space-around}.between-xs{justify-content:space-between}.first-xs{order:-1}.last-xs{order:1}@media only screen and (min-width:48em){.container{width:49rem}.col-sm,.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-offset-0,.col-sm-offset-1,.col-sm-offset-2,.col-sm-offset-3,.col-sm-offset-4,.col-sm-offset-5,.col-sm-offset-6,.col-sm-offset-7,.col-sm-offset-8,.col-sm-offset-9,.col-sm-offset-10,.col-sm-offset-11,.col-sm-offset-12{box-sizing:border-box;flex:0 0 auto;padding-right:.5rem;padding-left:.5rem}.col-sm{flex-grow:1;flex-basis:0;max-width:100%}.col-sm-1{flex-basis:8.33333333%;max-width:8.33333333%}.col-sm-2{flex-basis:16.66666667%;max-width:16.66666667%}.col-sm-3{flex-basis:25%;max-width:25%}.col-sm-4{flex-basis:33.33333333%;max-width:33.33333333%}.col-sm-5{flex-basis:41.66666667%;max-width:41.66666667%}.col-sm-6{flex-basis:50%;max-width:50%}.col-sm-7{flex-basis:58.33333333%;max-width:58.33333333%}.col-sm-8{flex-basis:66.66666667%;max-width:66.66666667%}.col-sm-9{flex-basis:75%;max-width:75%}.col-sm-10{flex-basis:83.33333333%;max-width:83.33333333%}.col-sm-11{flex-basis:91.66666667%;max-width:91.66666667%}.col-sm-12{flex-basis:100%;max-width:100%}.col-sm-offset-0{margin-left:0}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-11{margin-left:91.66666667%}.start-sm{justify-content:flex-start;text-align:start}.center-sm{justify-content:center;text-align:center}.end-sm{justify-content:flex-end;text-align:end}.top-sm{align-items:flex-start}.middle-sm{align-items:center}.bottom-sm{align-items:flex-end}.around-sm{justify-content:space-around}.between-sm{justify-content:space-between}.first-sm{order:-1}.last-sm{order:1}}@media only screen and (min-width:64em){.container{width:65rem}.col-md,.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12,.col-md-offset-0,.col-md-offset-1,.col-md-offset-2,.col-md-offset-3,.col-md-offset-4,.col-md-offset-5,.col-md-offset-6,.col-md-offset-7,.col-md-offset-8,.col-md-offset-9,.col-md-offset-10,.col-md-offset-11,.col-md-offset-12{box-sizing:border-box;flex:0 0 auto;padding-right:.5rem;padding-left:.5rem}.col-md{flex-grow:1;flex-basis:0;max-width:100%}.col-md-1{flex-basis:8.33333333%;max-width:8.33333333%}.col-md-2{flex-basis:16.66666667%;max-width:16.66666667%}.col-md-3{flex-basis:25%;max-width:25%}.col-md-4{flex-basis:33.33333333%;max-width:33.33333333%}.col-md-5{flex-basis:41.66666667%;max-width:41.66666667%}.col-md-6{flex-basis:50%;max-width:50%}.col-md-7{flex-basis:58.33333333%;max-width:58.33333333%}.col-md-8{flex-basis:66.66666667%;max-width:66.66666667%}.col-md-9{flex-basis:75%;max-width:75%}.col-md-10{flex-basis:83.33333333%;max-width:83.33333333%}.col-md-11{flex-basis:91.66666667%;max-width:91.66666667%}.col-md-12{flex-basis:100%;max-width:100%}.col-md-offset-0{margin-left:0}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-3{margin-left:25%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-6{margin-left:50%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-9{margin-left:75%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-11{margin-left:91.66666667%}.start-md{justify-content:flex-start;text-align:start}.center-md{justify-content:center;text-align:center}.end-md{justify-content:flex-end;text-align:end}.top-md{align-items:flex-start}.middle-md{align-items:center}.bottom-md{align-items:flex-end}.around-md{justify-content:space-around}.between-md{justify-content:space-between}.first-md{order:-1}.last-md{order:1}}@media only screen and (min-width:75em){.container{width:76rem}.col-lg,.col-lg-1,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-offset-0,.col-lg-offset-1,.col-lg-offset-2,.col-lg-offset-3,.col-lg-offset-4,.col-lg-offset-5,.col-lg-offset-6,.col-lg-offset-7,.col-lg-offset-8,.col-lg-offset-9,.col-lg-offset-10,.col-lg-offset-11,.col-lg-offset-12{box-sizing:border-box;flex:0 0 auto;padding-right:.5rem;padding-left:.5rem}.col-lg{flex-grow:1;flex-basis:0;max-width:100%}.col-lg-1{flex-basis:8.33333333%;max-width:8.33333333%}.col-lg-2{flex-basis:16.66666667%;max-width:16.66666667%}.col-lg-3{flex-basis:25%;max-width:25%}.col-lg-4{flex-basis:33.33333333%;max-width:33.33333333%}.col-lg-5{flex-basis:41.66666667%;max-width:41.66666667%}.col-lg-6{flex-basis:50%;max-width:50%}.col-lg-7{flex-basis:58.33333333%;max-width:58.33333333%}.col-lg-8{flex-basis:66.66666667%;max-width:66.66666667%}.col-lg-9{flex-basis:75%;max-width:75%}.col-lg-10{flex-basis:83.33333333%;max-width:83.33333333%}.col-lg-11{flex-basis:91.66666667%;max-width:91.66666667%}.col-lg-12{flex-basis:100%;max-width:100%}.col-lg-offset-0{margin-left:0}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-11{margin-left:91.66666667%}.start-lg{justify-content:flex-start;text-align:start}.center-lg{justify-content:center;text-align:center}.end-lg{justify-content:flex-end;text-align:end}.top-lg{align-items:flex-start}.middle-lg{align-items:center}.bottom-lg{align-items:flex-end}.around-lg{justify-content:space-around}.between-lg{justify-content:space-between}.first-lg{order:-1}.last-lg{order:1}}:root{--scale-element:1;--scale-font:1}@media (max-height:920px){:root{--scale-element:0.975;--scale-font:0.975}}@media (max-height:800px){:root{--scale-element:0.95;--scale-font:0.95}}@media (max-height:690px){:root{--scale-element:0.925;--scale-font:0.925}}body,html{min-height:100vh;background-color:#fff}html{-webkit-overflow-scrolling:touch;overflow-x:hidden;overflow-y:scroll;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box}*,:after,:before{box-sizing:inherit}body{font-size:13px;font-size:calc(13px*var(--scale-font));position:relative;margin:0;font-family:Roboto,sans-serif;line-height:1.5;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%;color:#333}@media (min-width:420px){body{font-size:13px;font-size:calc((.297vw + 11.75248px)*var(--scale-font))}}@media (min-width:1430px){body{font-size:16px;font-size:calc(16px*var(--scale-font))}}img{display:block;max-width:100%;height:auto}input::-webkit-input-placeholder,select::-webkit-input-placeholder,textarea::-webkit-input-placeholder{color:#ddd}input::-moz-placeholder,select::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#ddd}input:-ms-input-placeholder,select:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#ddd}a{color:#1a1a1a;font-weight:400;text-decoration:none;transition:opacity .2s ease-in-out}a:hover{opacity:.5}.AppLayout--layout--2MnEp{display:block;min-height:100vh}code[class*=language-],pre[class*=language-]{color:#000;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{position:relative;margin:.5em 0;overflow:visible;padding:0}pre[class*=language-]>code{position:relative;border-left:10px solid #358ccb;box-shadow:-1px 0 0 0 #358ccb,0 0 0 1px #dfdfdf;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%,rgba(69,142,209,.04) 0);background-size:3em 3em;background-origin:content-box;background-attachment:local}code[class*=language]{max-height:inherit;height:inherit;padding:0 1em;display:block;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdfdfd;box-sizing:border-box;margin-bottom:1em}:not(pre)>code[class*=language-]{position:relative;padding:.2em;border-radius:.3em;color:#c92c2c;border:1px solid rgba(0,0,0,.1);display:inline;white-space:normal}pre[class*=language-]:after,pre[class*=language-]:before{content:"";z-index:-2;display:block;position:absolute;bottom:.75em;left:.18em;width:40%;height:20%;max-height:13em;box-shadow:0 13px 8px #979797;transform:rotate(-2deg)}:not(pre)>code[class*=language-]:after,pre[class*=language-]:after{right:.75em;left:auto;transform:rotate(2deg)}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.7}@media screen and (max-width:767px){pre[class*=language-]:after,pre[class*=language-]:before{bottom:14px;box-shadow:none}}.token.cr:before,.token.lf:before,.token.tab:not(:empty):before{color:#e0d7d1}pre[class*=language-].line-numbers.line-numbers{padding-left:0}pre[class*=language-].line-numbers.line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers.line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-top:0;padding-bottom:0;padding-left:0}pre[data-line] code{position:relative;padding-left:4em}pre .line-highlight{margin-top:0}.AboutColumn--about_col--26z37{padding:6px 0;transition:opacity .2s ease-in-out;opacity:.7}.AboutColumn--about_col--26z37 ul{display:none}.AboutColumn--about_col--26z37:hover{opacity:1}.AboutColumn--about_col__avatar--2ngtn img{width:48px;height:48px;border-radius:50%;padding:5px;border:1px solid #f2f3f3}.AboutColumn--about_col__heading--3lDv_{font-size:22px;font-size:calc(22px*var(--scale-font));margin-bottom:5px;font-family:Open Sans,sans-serif;font-weight:300}@media (min-width:420px){.AboutColumn--about_col__heading--3lDv_{font-size:22px;font-size:calc((.396vw + 20.33663px)*var(--scale-font))}}@media (min-width:1430px){.AboutColumn--about_col__heading--3lDv_{font-size:26px;font-size:calc(26px*var(--scale-font))}}.AboutColumn--about_col__desc_container--3zM2q{padding:0;margin-left:12px}.AboutColumn--about_col__description--2PPLk{margin-bottom:5px;line-height:1.625;font-style:italic}.AboutColumn--about_col__details--2IU9H{line-height:2;-webkit-user-select:none;-ms-user-select:none;user-select:none}.AboutColumn--about_col__details__icon--GlkQJ{display:inline-block;width:28px}.AboutColumn--about_col__details__text--15yIn{padding:8px 0;font-weight:400}@media only screen and (min-width:48em){.AboutColumn--about_col--26z37{padding:60px 12px;max-width:100%}.AboutColumn--about_col--26z37 ul{display:block}.AboutColumn--about_col__avatar--2ngtn img{width:110px;height:110px}.AboutColumn--about_col__desc_container--3zM2q{margin-left:0}.AboutColumn--about_col__heading--3lDv_{margin-bottom:12px}.AboutColumn--about_col__description--2PPLk{margin-bottom:18px}}.PostsLayout--layout--Gqf2W{min-height:100vh}.PostsLayout--side_bar--13dgS{margin-left:auto;margin-right:auto}@media only screen and (min-width:48em){.PostsLayout--side_bar--13dgS{margin-left:0;margin-right:0}}.PostsLayout--posts_content--3-D5A{text-align:justify;margin-bottom:128px;margin-left:12px;margin-right:24px;width:100%}@media only screen and (min-width:48em){.PostsLayout--posts_content--3-D5A{margin-left:0;margin-right:0}}.PostsLayout--posts_content--3-D5A a{color:#497e60}.PostsLayout--posts_content--3-D5A ol,.PostsLayout--posts_content--3-D5A p,.PostsLayout--posts_content--3-D5A ul{margin:0 0 1.3em}.PostsLayout--posts_content--3-D5A h1{font-size:larger}.PostsLayout--posts_content--3-D5A h1,.PostsLayout--posts_content--3-D5A h2,.PostsLayout--posts_content--3-D5A h3,.PostsLayout--posts_content--3-D5A h4,.PostsLayout--posts_content--3-D5A h5,.PostsLayout--posts_content--3-D5A h6{font-weight:400;line-height:3em}.PostsLayout--posts_content--3-D5A ol{list-style:decimal inside}.PostsLayout--posts_content--3-D5A ul{list-style:inside}.PostsLayout--posts_content--3-D5A em{font-style:italic}.PostsLayout--posts_content--3-D5A strong{font-weight:400}.PostsLayout--posts_content--3-D5A sup{font-size:small}.PostsLayout--posts_content--3-D5A hr{border-bottom:1px solid #333;margin-bottom:8px}.PostsLayout--posts_content--3-D5A table{width:100%;border-collapse:collapse;border-spacing:.5rem;margin:18px 0}.PostsLayout--posts_content--3-D5A td,.PostsLayout--posts_content--3-D5A th{border:thin solid #999;padding:.5em}.PostsLayout--posts_content--3-D5A th{color:#479b6b;font-weight:400}.PostsLayout--posts_content--3-D5A blockquote{margin:2em 1em;border-left:.25em solid #666;padding-left:1em;font-style:italic}.PostsLayout--posts_content--3-D5A figcaption{margin:8px 0;font-size:.8em;text-align:center}div.gist-data{max-height:500px;line-height:normal}div.gist table{border-spacing:0}div.gist th,td{border:0!important;padding:.5em}div.gatsby-highlight{font-size:13px}.PageHeader--page_header--2rnMf{padding:20px 0;border-bottom:1px solid #e5e5e5}.PageHeader--page_header__text--1lzLq{font-size:26px;font-size:calc(26px*var(--scale-font));font-family:Open Sans,sans-serif;font-weight:300}@media (min-width:420px){.PageHeader--page_header__text--1lzLq{font-size:26px;font-size:calc((.594vw + 23.50495px)*var(--scale-font))}}@media (min-width:1430px){.PageHeader--page_header__text--1lzLq{font-size:32px;font-size:calc(32px*var(--scale-font))}}.BlogPost--post_meta--10FMO{margin-top:36px}.BlogPost--post_meta--10FMO span{font-weight:300}.BlogPost--post_meta--10FMO span svg{width:.8em;margin-right:12px}.BlogPost--post_content--1ZOta{margin-top:20px;margin-bottom:20px;font-size:16px;font-size:calc(16px*var(--scale-font));font-weight:300;line-height:1.625;padding-bottom:20px;border-bottom:1px solid #e5e5e5}@media (min-width:420px){.BlogPost--post_content--1ZOta{font-size:16px;font-size:calc((.198vw + 15.16832px)*var(--scale-font))}}@media (min-width:1430px){.BlogPost--post_content--1ZOta{font-size:18px;font-size:calc(18px*var(--scale-font))}}.Segment--segment--25ls6{flex-grow:1;padding-top:90px;padding-bottom:90px}@supports (--css:variables){.Segment--segment--25ls6{padding-top:calc(90px*var(--scale-element));padding-bottom:calc(90px*var(--scale-element))}}@media (min-width:720px){.Segment--segment--25ls6{padding-top:13.98601%;padding-bottom:13.98601%}@supports (--css:variables){.Segment--segment--25ls6{padding-top:calc(13.98601%*var(--scale-element));padding-bottom:calc(13.98601%*var(--scale-element))}}}@media (min-width:1430px){.Segment--segment--25ls6{padding-top:200px;padding-bottom:200px}@supports (--css:variables){.Segment--segment--25ls6{padding-top:calc(200px*var(--scale-element));padding-bottom:calc(200px*var(--scale-element))}}}.Row--row--1qryC{display:flex;flex-wrap:wrap;align-items:stretch;justify-content:flex-start;margin-left:-15px;margin-right:-15px;flex-direction:row}.Intro--intro--1ikoV{padding:60px 0;border-bottom:1px solid #e5e5e5}@media (min-width:768px){.Intro--intro--1ikoV{padding:120px 0}}.Intro--intro__col--1DEvw{flex:none;align-self:stretch;padding-left:15px;padding-right:15px;width:100%}@media (min-width:768px){.Intro--intro__col--1DEvw{flex:none;align-self:stretch;padding-left:15px;padding-right:15px;width:58.33333%}}.Intro--intro__text--3TVV0{font-size:26px;font-size:calc(26px*var(--scale-font));font-family:Open Sans,sans-serif;font-weight:300}@media (min-width:420px){.Intro--intro__text--3TVV0{font-size:26px;font-size:calc((.594vw + 23.50495px)*var(--scale-font))}}@media (min-width:1430px){.Intro--intro__text--3TVV0{font-size:32px;font-size:calc(32px*var(--scale-font))}}.Highlight--highlight--3UCQk{position:relative}.Highlight--highlight__text--Vp1sx{position:relative;z-index:1}.Highlight--isFirst--31-VV .Highlight--highlight__text--Vp1sx{padding-right:10px}.Highlight--highlight__color--1tDIQ{position:absolute;bottom:8px;left:0;z-index:0;width:100%;height:16px;background-color:rgba(142,255,191,.3)}.BlockText--block--dl83v{padding:60px 0}@media (min-width:768px){.BlockText--block--dl83v{padding:80px 0}}.BlockText--block__col--1qMGo{flex:none;align-self:stretch;padding-left:15px;padding-right:15px;width:100%}@media (min-width:768px){.BlockText--block__col--1qMGo{flex:none;align-self:stretch;padding-left:15px;padding-right:15px;width:41.66667%}}@media (min-width:768px){.BlockText--block__col--1qMGo.BlockText--full_width--2ucFH{flex:none;align-self:stretch;padding-left:15px;padding-right:15px;width:100%}}.BlockText--block__heading--jWMrW{font-size:16px;font-size:calc(16px*var(--scale-font));margin-bottom:10px;font-family:Open Sans,sans-serif}@media (min-width:420px){.BlockText--block__heading--jWMrW{font-size:16px;font-size:calc((.198vw + 15.16832px)*var(--scale-font))}}@media (min-width:1430px){.BlockText--block__heading--jWMrW{font-size:18px;font-size:calc(18px*var(--scale-font))}}.BlockText--block__heading--jWMrW a{display:inline-block;margin-left:12px!important}.BlockText--block__description--Sz8So{font-size:16px;font-size:calc(16px*var(--scale-font));font-weight:300;line-height:1.625}@media (min-width:420px){.BlockText--block__description--Sz8So{font-size:16px;font-size:calc((.198vw + 15.16832px)*var(--scale-font))}}@media (min-width:1430px){.BlockText--block__description--Sz8So{font-size:18px;font-size:calc(18px*var(--scale-font))}}.BlockText--block__description--Sz8So a{text-decoration:none;font-weight:400;color:#000;transition:opacity .2s ease-in-out}.BlockText--block__description--Sz8So a:hover{opacity:.5}.BlockText--block__description--Sz8So p{margin-bottom:1.3em}.PostTag--post_tag--pzPW_{padding:0 5px;margin:1px 4px 1px 0;border:1px solid #999;border-radius:2px;color:#333;opacity:.8}.PostBrief--post_brief--1CGN-{border:1px solid #e6e6e6;box-shadow:0 10px 10px 0 rgba(50,128,122,.2);border-radius:5px;padding:24px;margin:12px 12px 24px;opacity:.8;transition:opacity .2s ease-in-out}.PostBrief--post_brief--1CGN-:hover{opacity:1}.PostBrief--post_brief--1CGN-:after{content:"";clear:both;display:table}.PostBrief--post_brief--1CGN- header{font-family:Open Sans,sans-serif;font-weight:300}.PostBrief--post_brief--1CGN- header a{font-weight:400;line-height:1.5rem}.PostBrief--post_brief--1CGN- header.PostBrief--small--U54Cr a{display:block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.PostBrief--post_brief__meta--Zr7qE{font-size:.8em;display:inline-block}.PostBrief--post_brief__meta--Zr7qE svg{width:.8em}.PostBrief--post_brief__meta--Zr7qE.PostBrief--small--U54Cr{margin-top:5px;display:block}.PostBrief--post_brief__content--1ohV5{margin:12px 0;font-family:Roboto,sans-serif;text-align:justify}.PostBrief--post_brief__content--1ohV5.PostBrief--small--U54Cr{line-height:24px;max-height:120px;overflow:hidden;text-overflow:ellipsis}.PostBrief--post_brief__back_top--2QS3Q{float:right;text-transform:uppercase;font-size:.8em}.PostBrief--post_brief__back_top--2QS3Q.PostBrief--small--U54Cr{display:none}.PublishedYear--published_year--3MtIk{font-size:18px;font-size:calc(18px*var(--scale-font));margin:24px 12px 18px;padding:0 24px;font-family:Open Sans,sans-serif;font-weight:300}@media (min-width:420px){.PublishedYear--published_year--3MtIk{font-size:18px;font-size:calc((.594vw + 15.50495px)*var(--scale-font))}}@media (min-width:1430px){.PublishedYear--published_year--3MtIk{font-size:24px;font-size:calc(24px*var(--scale-font))}}</style><meta name="generator" content="Gatsby 2.21.10"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">Tutorial: Build AI to play Google Chrome Dino game with Reinforcement Learning in 30 minutes - Ngoc Nguyen&#x27;s Personal Blog</title><link data-react-helmet="true" rel="icon" type="image/x-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAMAAAANIilAAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAKVQTFRFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////VEBv8wAAADV0Uk5TAAIGCAMeR2qRrbyPaUic1fdCPafu7KYZjeorr/2uJjjNyAX+6e2EH9OQvQGbg0PrOo7HCTmYrbJMAAAAAWJLR0Q2R7+I0QAAAAlwSFlzAAAASAAAAEgARslrPgAAASxJREFUSMftlmtTgzAQRUlSbFMIYKoU2tLWPihStVrd///XfIwzjiObTQkzfuF8P5PsEO5dz+vp+S8YF4KzFuLAvxqO5Hgsg1D5g4tUoaI4gW+SOLoW1irXkxv4xW2quZ07zXL4Q55NbdzZfAENLIol7a7WgHC3Is9FXYD1jJi3AAOFce5NtjXJ22xjkPUOjOw07ooUCFL8tag9Je/Ro1lEuQAlJh9iWq4O2K0TWk4UIoe0CxAiI9/byKPmdODSRpbN/6aobeRadC87XfsY2MjBsftP5fZInJ4ne6DlRw/j6US5+TMqO4WBUwyRAfhiCkCn6PW85Rl3z2ThuNQNXnRzi6Jzq9imcj9NbMv9g1ddVj9rRVW+2a8Vn7CvhaauZTBUfpuNqPUq1dPTDe+aneJZFBlcXwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNi0xMS0xOFQxNTozMjo0NyswMDowMBJiPnAAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTYtMTEtMThUMTU6MzI6NDcrMDA6MDBjP4bMAAAARnRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA2LjcuOC05IDIwMTQtMDUtMTIgUTE2IGh0dHA6Ly93d3cuaW1hZ2VtYWdpY2sub3Jn3IbtAAAAABh0RVh0VGh1bWI6OkRvY3VtZW50OjpQYWdlcwAxp/+7LwAAABh0RVh0VGh1bWI6OkltYWdlOjpoZWlnaHQAMTkyDwByhQAAABd0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAAxOTLTrCEIAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADE0Nzk0ODMxNjfDDOUEAAAAD3RFWHRUaHVtYjo6U2l6ZQAwQkKUoj7sAAAAVnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vbW50bG9nL2Zhdmljb25zLzIwMTYtMTEtMTgvOTJiZjNlMDg0MGFkZWJjNjRlMjZhMzgzODFmM2RkMmMuaWNvLnBuZ7VafDgAAAAASUVORK5CYII="/><meta data-react-helmet="true" name="description" content="Ngoc Nguyen is a Singapore-based Software Developer. Currently employed @ 2359Media"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/><meta data-react-helmet="true" name="apple-mobile-web-app-status-bar-style" content="black"/><meta data-react-helmet="true" name="msapplication-navbutton-color" content="#000"/><meta data-react-helmet="true" name="msapplication-TileColor" content="#000"/><meta data-react-helmet="true" name="theme-color" content="#000"/><meta data-react-helmet="true" property="og:title" content="Ngoc Nguyen&#x27;s Personal Blog"/><meta data-react-helmet="true" property="og:image" content="/static/share-dee110c649a4613527a76746fe38ad6f.png"/><meta data-react-helmet="true" property="og:image:width" content="880px"/><meta data-react-helmet="true" property="og:image:height" content="440px"/><meta data-react-helmet="true" property="og:image:alt" content="Ngoc Nguyen is a Singapore-based Software Developer. Currently employed @ 2359Media"/><meta data-react-helmet="true" name="twitter:title" content="Ngoc Nguyen&#x27;s Personal Blog"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:image" content="/static/share-dee110c649a4613527a76746fe38ad6f.png"/><meta data-react-helmet="true" name="twitter:site" content="@luungoc2005"/><meta data-react-helmet="true" name="twitter:creator" content="@luungoc2005"/><meta data-react-helmet="true" name="twitter:description" content="Ngoc Nguyen is a Singapore-based Software Developer. Currently employed @ 2359Media"/><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"/><link rel="icon" href="/favicon-32x32.png?v=e8b5b511a71c71f442909c7048bf07c6"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=e8b5b511a71c71f442909c7048bf07c6"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=e8b5b511a71c71f442909c7048bf07c6"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=e8b5b511a71c71f442909c7048bf07c6"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=e8b5b511a71c71f442909c7048bf07c6"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=e8b5b511a71c71f442909c7048bf07c6"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=e8b5b511a71c71f442909c7048bf07c6"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=e8b5b511a71c71f442909c7048bf07c6"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=e8b5b511a71c71f442909c7048bf07c6"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-40d8356165c52017e040.js"/><link as="script" rel="preload" href="/framework-5dd3c501fd049989ea3a.js"/><link as="script" rel="preload" href="/app-6e8601cb757d9798e889.js"/><link as="script" rel="preload" href="/styles-8636a280cbc61d53ad10.js"/><link as="script" rel="preload" href="/component---src-components-blog-post-blog-post-tsx-47ff1ab6a59cdc040003.js"/><link as="fetch" rel="preload" href="/page-data/blog/2020-06-15-chrome-dino-game-reinforcement-learning/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="AppLayout--layout--2MnEp"><header class="Header--header--28-mG" id="page-title"><div class="Header--header__container--3a_BD"><div class="Header--header__content--19TvH"><a class="Header--header__logo--2Pboo" href="/"><h1>Ngoc Nguyen</h1><span>~ programming and stuffs</span></a><div class="Header--header__navigation--3RXf6"><a class="HeaderLink--link--XnUti" href="/blog">blog</a><a class="HeaderLink--link--XnUti" href="/about">about</a><a class="HeaderLink--link--XnUti" target="_blank" rel="noopener noreferrer" href="https://github.com/luungoc2005"><svg height="17" viewBox="0 0 18 17" width="18" class="HeaderLink--link__icon--19vgO"><title>Github</title><path d="m195.711029 1c-4.810968 0-8.711029 3.90006063-8.711029 8.71102924 0 3.85027496 2.500065 7.11691086 5.958344 8.27547776.435551.0696883.574928-.2003537.574928-.4355514 0-.2003537 0-.7491486 0-1.472164-2.412955.5226618-2.926906-1.1672779-2.926906-1.1672779-.400707-1.0104794-.966924-1.2805213-.966924-1.2805213-.792704-.5400838.060977-.5226618.060977-.5226618.871103.0609772 1.332788.8972361 1.332788.8972361.757859 1.3240764 2.03838.9320801 2.534909.7230154.078399-.5662169.304886-.9495022.548795-1.1672779-1.933849-.2177758-3.963518-.9669243-3.963518-4.28582642 0-.96692425.331019-1.74220585.897236-2.36068893-.087111-.21777573-.391997-1.12372277.08711-2.29971172 0 0 .731726-.23519779 2.395533.88852499.688171-.19164265 1.43732-.28746397 2.177757-.28746397.740438 0 1.489586.09582132 2.177758.28746397 1.663806-1.12372278 2.395533-.88852499 2.395533-.88852499.479106 1.17598895.17422 2.08193599.08711 2.29971172.566217.61848308.897236 1.39376468.897236 2.36068893 0 3.32761312-2.038381 4.05933962-3.98094 4.27711532.313597.2700419.601061.8014147.601061 1.6115404v2.3868221c0 .2351977.139376.5139507.583639.4355514 3.458278-1.1672779 5.949632-4.4252028 5.949632-8.27547776 0-2.3103086-.917766-4.52599297-2.551401-6.15962785-1.633635-1.63363487-3.849319-2.55140139-6.159628-2.55140139z" fill="#9ea0a6" transform="translate(-187 -1)"></path></svg>github</a></div></div></div></header><div class="PostsLayout--layout--Gqf2W"><div class="container-fluid row" style="margin-left:auto;margin-right:auto"><aside class="col-xs-12 col-sm-3 PostsLayout--side_bar--13dgS"><div class="row AboutColumn--about_col--26z37"><div class="col-xs-2 col-sm-12 AboutColumn--about_col__avatar--2ngtn"><img alt="Avatar" src="/static/avatar-b02e09c908376b498e9c9961bc2de3c8.png"/></div><div class="col-xs-8 col-sm-12 AboutColumn--about_col__desc_container--3zM2q"><div class="AboutColumn--about_col__heading--3lDv_">Ngoc Nguyen</div><div class="AboutColumn--about_col__description--2PPLk">Software Developer, AI Enthusiast, Coffee Addict, plays Piano</div></div><div class="AboutColumn--about_col__details--2IU9H"><ul><li><span class="AboutColumn--about_col__details__icon--GlkQJ"><svg class="svg-inline--fa fa-map-marker-alt fa-w-12 fa-fw" width="18" height="18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="map-marker-alt" role="img" viewBox="0 0 384 512" data-fa-i2svg=""><title>Location</title><path fill="currentColor" d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"></path></svg></span><span class="AboutColumn--about_col__details__text--15yIn">Singapore</span></li><li><a alt="Twitter" href="https://twitter.com/luungoc2005" target="_blank" rel="noopener noreferrer"><span class="AboutColumn--about_col__details__icon--GlkQJ"><svg width="20px" height="15px" viewBox="0 0 20 15" version="1.1"><title>Twitter</title><defs></defs><g id="Good-One" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Footer_06" transform="translate(-1091.000000, -3948.000000)" fill="#9EA0A6"><g id="Group-7" transform="translate(0.000000, 3204.000000)"><g id="Group-6" transform="translate(75.000000, 733.000000)"><g id="dribbble" transform="translate(976.000000, 9.000000)"><path d="M53.2813915,2 C51.0959361,2 49.3247358,3.69382235 49.3247358,5.78774534 C49.3247358,6.08310267 49.3596502,6.37374182 49.4275918,6.64928284 C46.1380851,6.48980876 43.2222572,4.98471314 41.2708228,2.68885254 C40.9301711,3.25031454 40.7357826,3.90142174 40.7357826,4.59593608 C40.7357826,5.91041772 41.4331278,7.07014343 42.4956593,7.74672874 C41.8464394,7.72974333 41.236852,7.55800201 40.7027554,7.27396829 C40.7027554,7.29001007 40.7027554,7.30605184 40.7027554,7.32303724 C40.7027554,9.157461 42.066306,10.6880347 43.8771389,11.0362355 C43.5449799,11.1221062 43.1958354,11.1692879 42.8344238,11.1692879 C42.5796427,11.1692879 42.331467,11.1447534 42.0898968,11.1032335 C42.5937972,12.603611 44.0554857,13.7038878 45.7870533,13.7331404 C44.4319955,14.7447157 42.7259059,15.3552466 40.8726095,15.3552466 C40.5527177,15.3552466 40.237544,15.3344867 39.9280322,15.3014595 C41.6794162,16.3753145 43.7591847,17 45.9937091,17 C53.2719552,17 57.2522018,11.2287368 57.2522018,6.22464771 C57.2522018,6.06328636 57.2484273,5.89720684 57.2408782,5.73490186 C58.0146578,5.20080523 58.6855813,4.53648717 59.2159034,3.7768621 C58.5062909,4.07505033 57.7438349,4.27887519 56.9436336,4.37135128 C57.7598767,3.90142174 58.3873931,3.16066935 58.6827504,2.27648465 C57.9184071,2.70961248 57.0710242,3.02478611 56.1707977,3.19369653 C55.4479743,2.45954957 54.4203573,2 53.2813915,2" id="Fill-1"></path></g></g></g></g></g></svg></span><span class="AboutColumn--about_col__details__text--15yIn">Twitter</span></a></li><li><a alt="Github" href="https://github.com/luungoc2005" target="_blank" rel="noopener noreferrer"><span class="AboutColumn--about_col__details__icon--GlkQJ"><svg height="17" viewBox="0 0 18 17" width="18"><title>Github</title><path d="m195.711029 1c-4.810968 0-8.711029 3.90006063-8.711029 8.71102924 0 3.85027496 2.500065 7.11691086 5.958344 8.27547776.435551.0696883.574928-.2003537.574928-.4355514 0-.2003537 0-.7491486 0-1.472164-2.412955.5226618-2.926906-1.1672779-2.926906-1.1672779-.400707-1.0104794-.966924-1.2805213-.966924-1.2805213-.792704-.5400838.060977-.5226618.060977-.5226618.871103.0609772 1.332788.8972361 1.332788.8972361.757859 1.3240764 2.03838.9320801 2.534909.7230154.078399-.5662169.304886-.9495022.548795-1.1672779-1.933849-.2177758-3.963518-.9669243-3.963518-4.28582642 0-.96692425.331019-1.74220585.897236-2.36068893-.087111-.21777573-.391997-1.12372277.08711-2.29971172 0 0 .731726-.23519779 2.395533.88852499.688171-.19164265 1.43732-.28746397 2.177757-.28746397.740438 0 1.489586.09582132 2.177758.28746397 1.663806-1.12372278 2.395533-.88852499 2.395533-.88852499.479106 1.17598895.17422 2.08193599.08711 2.29971172.566217.61848308.897236 1.39376468.897236 2.36068893 0 3.32761312-2.038381 4.05933962-3.98094 4.27711532.313597.2700419.601061.8014147.601061 1.6115404v2.3868221c0 .2351977.139376.5139507.583639.4355514 3.458278-1.1672779 5.949632-4.4252028 5.949632-8.27547776 0-2.3103086-.917766-4.52599297-2.551401-6.15962785-1.633635-1.63363487-3.849319-2.55140139-6.159628-2.55140139z" fill="#9ea0a6" transform="translate(-187 -1)"></path></svg></span><span class="AboutColumn--about_col__details__text--15yIn">Github</span></a></li><li><a alt="Facebook" href="https://www.facebook.com/luungoc2005" target="_blank" rel="noopener noreferrer"><span class="AboutColumn--about_col__details__icon--GlkQJ"><svg width="9px" height="18px" viewBox="0 0 9 18" version="1.1"><title>Facebook</title><defs></defs><g id="Good-One" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Footer_06" transform="translate(-1051.000000, -3946.000000)" fill="#9EA0A6" fill-rule="nonzero"><g id="Group-7" transform="translate(0.000000, 3204.000000)"><g id="Group-6" transform="translate(75.000000, 733.000000)"><g id="dribbble" transform="translate(976.000000, 9.000000)"><path d="M9,0 L9,3.6 L7.2,3.6 C6.579,3.6 6.3,4.329 6.3,4.95 L6.3,7.2 L9,7.2 L9,10.8 L6.3,10.8 L6.3,18 L2.7,18 L2.7,10.8 L0,10.8 L0,7.2 L2.7,7.2 L2.7,3.6 C2.7,1.6117749 4.3117749,3.99680289e-16 6.3,0 L9,0 Z" id="Shape"></path></g></g></g></g></g></svg></span><span class="AboutColumn--about_col__details__text--15yIn">Facebook</span></a></li><li><a alt="LinkedIn" href="https://www.linkedin.com/in/luungoc2005/" target="_blank" rel="noopener noreferrer"><span class="AboutColumn--about_col__details__icon--GlkQJ"><svg width="18" height="18" viewBox="0 0 18 18"><title>
    LinkedIn
  </title><path fill="#9EA0A6" fill-rule="nonzero" d="M18 18h-4v-6.75c0-1.06-1.19-1.94-2.25-1.94S10 10.19 10 11.25V18H6V6h4v2c.66-1.07 2.36-1.76 3.5-1.76 2.5 0 4.5 2.04 4.5 4.51V18zM4 18H0V6h4v12zM2 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path></svg></span><span class="AboutColumn--about_col__details__text--15yIn">LinkedIn</span></a></li></ul></div></div></aside><section class="col-xs-12 col-sm-9 PostsLayout--posts_content--3-D5A"><header><div class="PageHeader--page_header--2rnMf"><p class="PageHeader--page_header__text--1lzLq">Tutorial: Build AI to play Google Chrome Dino game with Reinforcement Learning in 30 minutes</p></div></header><section class="BlogPost--post_meta--10FMO"><span><svg class="svg-inline--fa fa-calendar-alt fa-w-14 fa-fw" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="calendar-alt" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"></path></svg>Jun 15<!-- --> · <!-- -->9 min read</span></section><article class="BlogPost--post_content--1ZOta"><h1>Introduction</h1>
<hr>
<div class="custom-block snippet"><div class="custom-block-body"><p>In this tutorial I will briefly walk through how you can create an OpenAI Gym environment for the Google Chrome Dino game, and use Stable Baselines to quickly train an agent for it. Bonus: The environment can be easily extended to other browser games as well!.</p></div></div>
<p>This tutorial assumes you are at least familiar with Python in general. It will not go deep into model development or length explanations - that I'll save for another time. If you are new to machine learning, this will hopefully pique your interest 😋.</p>
<h1>Preparation</h1>
<hr>
<p>Ideally, you already have installed a environment manager for Python, such as <code class="language-text">pipenv</code> or <code class="language-text">Anaconda</code>/<code class="language-text">Miniconda</code>. Create a new environment in Python 3.6 (with Python 3.7 you may have trouble installing Tensorflow because we will be using an older version).</p>
<p>We will be needing the following dependencies:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">gym
selenium
opencv
Pillow
stable-baselines</code></pre></div>
<p>Since this project will be to play the Dino game, we will also need Google Chrome and Chrome driver for selenium, which can be downloaded here: <a href="https://chromedriver.chromium.org/downloads">https://chromedriver.chromium.org/downloads</a> . Select the latest version and download the binary for your OS, and extract it into your project's working folder.</p>
<h1>Selenium and the Chrome Dino game</h1>
<hr>
<p>For this part we will need some frontend knowledge and dig around with the Chrome inspector and console. The Chrome Dino game itself is comparably very convenient, but it might not be so for other games.</p>
<p>First we define the webdriver object with:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

_chrome_options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>
_chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--mute-audio"</span><span class="token punctuation">)</span>

_driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>
    executable_path<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>
        os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"chromedriver"</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    chrome_options<span class="token operator">=</span>_chrome_options
<span class="token punctuation">)</span></code></pre></div>
<p>After which we can launch the game by going to <code class="language-text">chrome://dino</code>:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys

_driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'chrome://dino'</span><span class="token punctuation">)</span>

<span class="token comment"># trigger game start by pressing spacebar</span>
_driver \
    <span class="token punctuation">.</span>find_element_by_tag_name<span class="token punctuation">(</span><span class="token string">"body"</span><span class="token punctuation">)</span> \
    <span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>SPACE<span class="token punctuation">)</span></code></pre></div>
<p>The game screen itself is rendered to a <code class="language-text">canvas</code> with <code class="language-text">class=&quot;runner-canvas&quot;</code>, therefore we can easily get the entire game screen with <code class="language-text">.toDataURL()</code></p>
<p>The game also exposes a <code class="language-text">Runner</code> object to global space (convenient! in the world of minifiers...), where we can get whether the game is still running with <code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Runner<span class="token punctuation">.</span>instance_<span class="token punctuation">.</span>playing<span class="token punctuation">)</span></code>. The score can be read from <code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Runner<span class="token punctuation">.</span>instance_<span class="token punctuation">.</span>distanceMeter<span class="token punctuation">.</span>digits<span class="token punctuation">)</span></code> as an array of digits, though that is not entirely necessary because the game is an endless runner - meaning we can just keep rewarding the agent until the game stops.</p>
<p>Similarly, controls to the game can be sent with <code class="language-text">send_keys</code>.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys

_driver<span class="token punctuation">.</span>find_element_by_tag_name<span class="token punctuation">(</span><span class="token string">"body"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>SPACE<span class="token punctuation">)</span></code></pre></div>
<p>For other games, however, <code class="language-text">send_keys</code> only simulates a key press event. Sometimes the game would require the keys to be <em>held down</em> instead, which will require sending the key down and key up events individually. In other cases, some actions in the game might require a certain <em>sequence</em> of key presses and the odds might be too low for the AI to be able to figure out. In those cases, we can use Selenium's <code class="language-text">ActionChains</code>:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains

action_chains <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>_driver<span class="token punctuation">)</span>
action_chains<span class="token punctuation">.</span>key_down<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ARROW_UP<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
action_chains<span class="token punctuation">.</span>key_up<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ARROW_UP<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<h1>Creating a custom OpenAI Gym environment</h1>
<hr>
<p>An <em>environment</em> is how you can define the target that a reinforcement learning algorithm would run on. The idea is the algorithm, or <em>agent</em>, have to be able to observe the current environment's state, make actions, and know what kind of rewards that each action would bring. In the context of a simple game, the actions would be key presses, and the state can be pixels on the screen.</p>
<p>A minimal Gym environment would look like this</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> gym
<span class="token keyword">from</span> gym <span class="token keyword">import</span> spaces

<span class="token keyword">class</span> <span class="token class-name">CustomEnv</span><span class="token punctuation">(</span>gym<span class="token punctuation">.</span>Env<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># action_space and observation_space can be anything from spaces</span>
        self<span class="token punctuation">.</span>action_space <span class="token operator">=</span> spaces<span class="token punctuation">.</span>Discrete<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>observation_space <span class="token operator">=</span> spaces<span class="token punctuation">.</span>Box<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">step</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
        <span class="token comment"># return observation, reward, done, extra_info</span>

    <span class="token keyword">def</span> <span class="token function">render</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'human'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
        <span class="token comment"># return image array</span>

    <span class="token keyword">def</span> <span class="token function">reset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token comment"># not required</span>
    <span class="token keyword">def</span> <span class="token function">close</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span></code></pre></div>
<p>In <code class="language-text">__init__</code> you would define the <code class="language-text">action_space</code> and <code class="language-text">observation_space</code>. <code class="language-text">action_space</code> in this case is straightforward: The Dino can either do nothing, jump up (spacebar or up arrow key) or duck (down arrow key), so we can use <code class="language-python">spaces<span class="token punctuation">.</span>Discrete<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span></code> to model this. For other games that might require more keys to control, you can adjust accordingly.</p>
<p><em>Side note:</em> In this case, initially, I thought the dino would only need jump and duck actions - and having a smaller action space would help the model learn faster. That did not end up being the case, since the duck action <em>can</em> cancel out the jump action, therefore leaving only the 2 will make it hard for the agent to even jump past 1 obstacle.</p>
<h2>The step function</h2>
<p><code class="language-text">step</code> is arguably the most important function to define for a Gym environment. This is where you would define how an action can affect the environment, and how to observe the current state of the environment. As can be seen from the skeleton code above, it is supposed to return 4 values as follows:</p>
<ul>
<li><code class="language-text">observation</code>: We need to convert the state of the environment into a fixed array format to feed into the model. In this case we can use the screenshot of the game directly, but a lot of other games might require additional information.</li>
</ul>
<p>The interesting part of this is thanks to the power of <em>deep learning</em>, the agent can use the pixels on the screen as its input. This means we don't have to use any custom, hand-crafted object detection techniques for detecting obstacles. However, normally, neural network for <em>vision</em> often resize images down to a very small size for performance. To put things into perspective, the state-of-the-art models usually use image sizes of up to 512x512px. This means you cannot just use 4K game screenshots as no conventional neural networks will be able to handle it. If need be, workarounds include splitting the image into parts, or isolate regions of interest.</p>
<p>As demonstration, for this game I cropped out only the part of the screen in front of the <em>Dino</em> and resize the image down to 96x96px. It's worth noting, however, that the original Deep-Q-Learning on Atari games paper do just take the entire screen - including the scores and such. So that actually would still work for this game, it will just not be as efficient.</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 120px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/85c6c7aecff09bb8d08fb15e8a8b0f42/e439a/chrome-dino-game-reinforcement-learning-observation.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBv/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAefa5FJG0AB//8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECEBIRE//aAAgBAQABBQKuMUG416Szo0f/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAdEAAABQUAAAAAAAAAAAAAAAAAARBBkQIREiEx/9oACAEBAAY/AlOpiXHVg0DhQP/EABsQAAIDAAMAAAAAAAAAAAAAAAARARBRQWFx/9oACAEBAAE/Ia6pHmWnN+0NIbAgL//aAAwDAQACAAMAAAAQAMA8/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHRABAAICAgMAAAAAAAAAAAAAAQARECFhgTFx8f/aAAgBAQABPxDA5puojQURDutUc4t5nkbatND6nw0Wtt0n/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="This is what the agent actually sees"
        title="This is what the agent actually sees"
        src="/static/85c6c7aecff09bb8d08fb15e8a8b0f42/e439a/chrome-dino-game-reinforcement-learning-observation.jpg"
        srcset="/static/85c6c7aecff09bb8d08fb15e8a8b0f42/e439a/chrome-dino-game-reinforcement-learning-observation.jpg 120w"
        sizes="(max-width: 120px) 100vw, 120px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption"><p>This is what the agent actually sees</p></figcaption>
  </figure></p>
<p>Because the game does speed up after a while, we attempt to capture part of this information by collating 4 latest screenshots for every observation - which is also what the authors of the original Deep Q Learning on Atari games paper did.</p>
<ul>
<li><code class="language-text">reward</code>: Reward modeling is arguably the hardest part of Reinforcement learning: RL is notorious for exploiting the environment. For example, if a game was designed that the score increases when you take respawnable power-ups, and the score is used as the model's reward, the model would learn to repeatedly take the power-up rather than get to the goal and finish the game, which is what happens here:</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/tlOIHko8ySg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p><em>This agent actually manages to get ~20% higher scores than human players</em></p>
<p>In our case, we can either use the score as the reward or, because we prefer stepwise reward to overall reward (easier for the model), just <code class="language-text">.1</code> if the dinosaur still survives and <code class="language-text">-1</code> when it crashes. This is to make the model disproportionately penalizes the agent when it crashes. This detail is unimportant, however, as most algorithms also considers episode-wise rewards, which would be the final score after the game ended.</p>
<p>In this case, the reward is straightforward because our goal - to survive as long as possible - is simple to model. Other games may require some trial and error for this step. Because how Reinforcement Learning works is first <em>random exploration</em>, essentially throwing things at the wall to see what sticks, it might never get to the goal if it's too hard to randomly press buttons and get to checkpoints or goals for rewards. That's why - for example - a game of <em>snake</em> may require the <em>distance between the snake's head and the pellet</em> to be factored into the reward.</p>
<ul>
<li><code class="language-text">done</code> is just a boolean value to indicate whether the game has ended.</li>
</ul>
<p>And finally,</p>
<ul>
<li><code class="language-text">extra_info</code> is any extra information that does not fit into the other return values, often used for logging purposes. You can just return a <code class="language-text">None</code> or empty <code class="language-text">{}</code> value instead.</li>
</ul>
<h1>Use stable-baselines to validate the environment</h1>
<hr>
<p>We can lift code straight out of <code class="language-text">stable-baselines</code>'s <a href="https://stable-baselines.readthedocs.io/en/master/guide/examples.html?highlight=gif#id2">examples</a> and modify it <em>just</em> a bit to fit our needs.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> os

<span class="token keyword">from</span> stable_baselines <span class="token keyword">import</span> DQN
<span class="token keyword">from</span> stable_baselines<span class="token punctuation">.</span>deepq<span class="token punctuation">.</span>policies <span class="token keyword">import</span> CnnPolicy
<span class="token keyword">from</span> stable_baselines<span class="token punctuation">.</span>common<span class="token punctuation">.</span>vec_env <span class="token keyword">import</span> DummyVecEnv

env_lambda <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> ChromeDinoEnv<span class="token punctuation">(</span>
    screen_width<span class="token operator">=</span><span class="token number">96</span><span class="token punctuation">,</span>
    screen_height<span class="token operator">=</span><span class="token number">96</span><span class="token punctuation">,</span>
    chromedriver_path<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>
        os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"chromedriver"</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
save_path <span class="token operator">=</span> <span class="token string">"chrome_dino_dqn_cnn"</span>
env <span class="token operator">=</span> DummyVecEnv<span class="token punctuation">(</span><span class="token punctuation">[</span>env_lambda<span class="token punctuation">]</span><span class="token punctuation">)</span>

model <span class="token operator">=</span> DQN<span class="token punctuation">(</span>
    CnnPolicy<span class="token punctuation">,</span>
    env<span class="token punctuation">,</span>
    verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    tensorboard_log<span class="token operator">=</span><span class="token string">"./.tb_chromedino_env/"</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
model<span class="token punctuation">.</span>learn<span class="token punctuation">(</span>total_timesteps<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>save<span class="token punctuation">(</span>save_path<span class="token punctuation">)</span>

model <span class="token operator">=</span> DQN<span class="token punctuation">.</span>load<span class="token punctuation">(</span>save_path<span class="token punctuation">,</span> env<span class="token operator">=</span>env<span class="token punctuation">)</span>

obs <span class="token operator">=</span> env<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    action<span class="token punctuation">,</span> _states <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>obs<span class="token punctuation">)</span>
    obs<span class="token punctuation">,</span> reward<span class="token punctuation">,</span> done<span class="token punctuation">,</span> info <span class="token operator">=</span> env<span class="token punctuation">.</span>step<span class="token punctuation">(</span>action<span class="token punctuation">)</span>
    env<span class="token punctuation">.</span>render<span class="token punctuation">(</span>mode<span class="token operator">=</span><span class="token string">"human"</span><span class="token punctuation">)</span></code></pre></div>
<p>This will lead to pretty decent results - if only for demonstrative purposes. You can increase the number of training timesteps for better results (might take a few million steps to master the game). It will, by default, use Deep-Q Learning along with extensions (Dueling, Double-DQN and Prioritized Experience Replay).</p>
<p>As <code class="language-text">DQN</code> does not support multiprocessing, however, we can opt for <code class="language-text">PPO</code> to hasten the training process. Important note though: even if I can use these algorithms interchangeably in these cases, a lot of times, some algorithms are designed for certain scenarios, while others might not even converge on certain problems. It might even take some trial and error to choose the right algorithm. A starting guideline can be found on <code class="language-text">stable-baselines</code> docs: <a href="https://stable-baselines.readthedocs.io/en/master/guide/rl_tips.html#which-algorithm-should-i-use">https://stable-baselines.readthedocs.io/en/master/guide/rl_tips.html#which-algorithm-should-i-use</a></p>
<p>With this we can train and run 4 agents at once, simultaneously - which can speed up training by a lot - especially since we cannot fast-forward browser games as compared to emulators. Here is an agent that has been trained for a few hours with the <code class="language-text">PPO</code> algorithm: (screenshots are taken directly from Chrome, the black background is due to transparency)</p>
<p><img src="/static/271fdad092161b2156e5cad8e5925a6b/chrome-dino-game-reinforcement-learning-observation-agent.gif" alt="Running 4 instances at once with a trained agent"></p>
<p>The complete version of the code can be found here:</p>
<p><div id="gist103736652" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-gym_chrome_dino_game-py" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-gym_chrome_dino_game-py-LC1" class="blob-code blob-code-inner js-file-line"><span class=pl-k>import</span> <span class=pl-s1>numpy</span> <span class=pl-k>as</span> <span class=pl-s1>np</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-gym_chrome_dino_game-py-LC2" class="blob-code blob-code-inner js-file-line"><span class=pl-k>import</span> <span class=pl-s1>os</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-gym_chrome_dino_game-py-LC3" class="blob-code blob-code-inner js-file-line"><span class=pl-k>import</span> <span class=pl-s1>gym</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-gym_chrome_dino_game-py-LC4" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>gym</span> <span class=pl-k>import</span> <span class=pl-s1>error</span>, <span class=pl-s1>spaces</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-gym_chrome_dino_game-py-LC5" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>collections</span> <span class=pl-k>import</span> <span class=pl-s1>deque</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-gym_chrome_dino_game-py-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-gym_chrome_dino_game-py-LC7" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>io</span> <span class=pl-k>import</span> <span class=pl-v>BytesIO</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-gym_chrome_dino_game-py-LC8" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-v>PIL</span> <span class=pl-k>import</span> <span class=pl-v>Image</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-gym_chrome_dino_game-py-LC9" class="blob-code blob-code-inner js-file-line"><span class=pl-k>import</span> <span class=pl-s1>base64</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-gym_chrome_dino_game-py-LC10" class="blob-code blob-code-inner js-file-line"><span class=pl-k>import</span> <span class=pl-s1>cv2</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-gym_chrome_dino_game-py-LC11" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-gym_chrome_dino_game-py-LC12" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>selenium</span> <span class=pl-k>import</span> <span class=pl-s1>webdriver</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-gym_chrome_dino_game-py-LC13" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>selenium</span>.<span class=pl-s1>webdriver</span>.<span class=pl-s1>common</span>.<span class=pl-s1>keys</span> <span class=pl-k>import</span> <span class=pl-v>Keys</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-gym_chrome_dino_game-py-LC14" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>selenium</span>.<span class=pl-s1>webdriver</span>.<span class=pl-s1>common</span>.<span class=pl-s1>by</span> <span class=pl-k>import</span> <span class=pl-v>By</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-gym_chrome_dino_game-py-LC15" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>selenium</span>.<span class=pl-s1>webdriver</span>.<span class=pl-s1>common</span>.<span class=pl-s1>action_chains</span> <span class=pl-k>import</span> <span class=pl-v>ActionChains</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-gym_chrome_dino_game-py-LC16" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>selenium</span>.<span class=pl-s1>webdriver</span>.<span class=pl-s1>support</span>.<span class=pl-s1>ui</span> <span class=pl-k>import</span> <span class=pl-v>WebDriverWait</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-gym_chrome_dino_game-py-LC17" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>selenium</span>.<span class=pl-s1>webdriver</span>.<span class=pl-s1>support</span> <span class=pl-k>import</span> <span class=pl-s1>expected_conditions</span> <span class=pl-k>as</span> <span class=pl-v>EC</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-gym_chrome_dino_game-py-LC18" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-gym_chrome_dino_game-py-LC19" class="blob-code blob-code-inner js-file-line"><span class=pl-k>import</span> <span class=pl-s1>time</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-gym_chrome_dino_game-py-LC20" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-gym_chrome_dino_game-py-LC21" class="blob-code blob-code-inner js-file-line"><span class=pl-k>class</span> <span class=pl-v>ChromeDinoEnv</span>(<span class=pl-s1>gym</span>.<span class=pl-v>Env</span>):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-gym_chrome_dino_game-py-LC22" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-gym_chrome_dino_game-py-LC23" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>def</span> <span class=pl-en>__init__</span>(<span class=pl-s1>self</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-gym_chrome_dino_game-py-LC24" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>screen_width</span>: <span class=pl-s1>int</span><span class=pl-c1>=</span><span class=pl-c1>120</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-gym_chrome_dino_game-py-LC25" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>screen_height</span>: <span class=pl-s1>int</span><span class=pl-c1>=</span><span class=pl-c1>120</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-gym_chrome_dino_game-py-LC26" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>chromedriver_path</span>: <span class=pl-s1>str</span><span class=pl-c1>=</span><span class=pl-s>&quot;chromedriver&quot;</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-gym_chrome_dino_game-py-LC27" class="blob-code blob-code-inner js-file-line">        ):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-gym_chrome_dino_game-py-LC28" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>screen_width</span> <span class=pl-c1>=</span> <span class=pl-s1>screen_width</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-gym_chrome_dino_game-py-LC29" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>screen_height</span> <span class=pl-c1>=</span> <span class=pl-s1>screen_height</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-gym_chrome_dino_game-py-LC30" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>chromedriver_path</span> <span class=pl-c1>=</span> <span class=pl-s1>chromedriver_path</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-gym_chrome_dino_game-py-LC31" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-gym_chrome_dino_game-py-LC32" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>action_space</span> <span class=pl-c1>=</span> <span class=pl-s1>spaces</span>.<span class=pl-v>Discrete</span>(<span class=pl-c1>3</span>) <span class=pl-c># do nothing, up, down</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-gym_chrome_dino_game-py-LC33" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>observation_space</span> <span class=pl-c1>=</span> <span class=pl-s1>spaces</span>.<span class=pl-v>Box</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-gym_chrome_dino_game-py-LC34" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>low</span><span class=pl-c1>=</span><span class=pl-c1>0</span>, </td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-gym_chrome_dino_game-py-LC35" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>high</span><span class=pl-c1>=</span><span class=pl-c1>255</span>, </td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-gym_chrome_dino_game-py-LC36" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>shape</span><span class=pl-c1>=</span>(<span class=pl-s1>self</span>.<span class=pl-s1>screen_width</span>, <span class=pl-s1>self</span>.<span class=pl-s1>screen_height</span>, <span class=pl-c1>4</span>), </td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-gym_chrome_dino_game-py-LC37" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>dtype</span><span class=pl-c1>=</span><span class=pl-s1>np</span>.<span class=pl-s1>uint8</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-gym_chrome_dino_game-py-LC38" class="blob-code blob-code-inner js-file-line">        )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-gym_chrome_dino_game-py-LC39" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-gym_chrome_dino_game-py-LC40" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>_chrome_options</span> <span class=pl-c1>=</span> <span class=pl-s1>webdriver</span>.<span class=pl-v>ChromeOptions</span>()</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-gym_chrome_dino_game-py-LC41" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>_chrome_options</span>.<span class=pl-en>add_argument</span>(<span class=pl-s>&quot;--mute-audio&quot;</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-gym_chrome_dino_game-py-LC42" class="blob-code blob-code-inner js-file-line">        <span class=pl-c># _chrome_options.add_argument(&quot;--disable-gpu&quot;) # if running on Windows</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-gym_chrome_dino_game-py-LC43" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-gym_chrome_dino_game-py-LC44" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>_driver</span> <span class=pl-c1>=</span> <span class=pl-s1>webdriver</span>.<span class=pl-v>Chrome</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-gym_chrome_dino_game-py-LC45" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>executable_path</span><span class=pl-c1>=</span><span class=pl-s1>self</span>.<span class=pl-s1>chromedriver_path</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-gym_chrome_dino_game-py-LC46" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>chrome_options</span><span class=pl-c1>=</span><span class=pl-s1>_chrome_options</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-gym_chrome_dino_game-py-LC47" class="blob-code blob-code-inner js-file-line">        )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-gym_chrome_dino_game-py-LC48" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>current_key</span> <span class=pl-c1>=</span> <span class=pl-c1>None</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-gym_chrome_dino_game-py-LC49" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>state_queue</span> <span class=pl-c1>=</span> <span class=pl-en>deque</span>(<span class=pl-s1>maxlen</span><span class=pl-c1>=</span><span class=pl-c1>4</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-gym_chrome_dino_game-py-LC50" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-gym_chrome_dino_game-py-LC51" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>actions_map</span> <span class=pl-c1>=</span> [</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-gym_chrome_dino_game-py-LC52" class="blob-code blob-code-inner js-file-line">            <span class=pl-v>Keys</span>.<span class=pl-v>ARROW_RIGHT</span>, <span class=pl-c># do nothing</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-gym_chrome_dino_game-py-LC53" class="blob-code blob-code-inner js-file-line">            <span class=pl-v>Keys</span>.<span class=pl-v>ARROW_UP</span>, <span class=pl-c># jump</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-gym_chrome_dino_game-py-LC54" class="blob-code blob-code-inner js-file-line">            <span class=pl-v>Keys</span>.<span class=pl-v>ARROW_DOWN</span> <span class=pl-c># duck</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-gym_chrome_dino_game-py-LC55" class="blob-code blob-code-inner js-file-line">        ]</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-gym_chrome_dino_game-py-LC56" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>action_chains</span> <span class=pl-c1>=</span> <span class=pl-v>ActionChains</span>(<span class=pl-s1>self</span>.<span class=pl-s1>_driver</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-gym_chrome_dino_game-py-LC57" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>keydown_actions</span> <span class=pl-c1>=</span> [<span class=pl-s1>action_chains</span>.<span class=pl-en>key_down</span>(<span class=pl-s1>item</span>) <span class=pl-k>for</span> <span class=pl-s1>item</span> <span class=pl-c1>in</span> <span class=pl-s1>self</span>.<span class=pl-s1>actions_map</span>]</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-gym_chrome_dino_game-py-LC58" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>keyup_actions</span> <span class=pl-c1>=</span> [<span class=pl-s1>action_chains</span>.<span class=pl-en>key_up</span>(<span class=pl-s1>item</span>) <span class=pl-k>for</span> <span class=pl-s1>item</span> <span class=pl-c1>in</span> <span class=pl-s1>self</span>.<span class=pl-s1>actions_map</span>]</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-gym_chrome_dino_game-py-LC59" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L60" class="blob-num js-line-number" data-line-number="60"></td>
        <td id="file-gym_chrome_dino_game-py-LC60" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>def</span> <span class=pl-en>reset</span>(<span class=pl-s1>self</span>):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L61" class="blob-num js-line-number" data-line-number="61"></td>
        <td id="file-gym_chrome_dino_game-py-LC61" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>_driver</span>.<span class=pl-en>get</span>(<span class=pl-s>&#39;chrome://dino&#39;</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L62" class="blob-num js-line-number" data-line-number="62"></td>
        <td id="file-gym_chrome_dino_game-py-LC62" class="blob-code blob-code-inner js-file-line">        <span class=pl-v>WebDriverWait</span>(<span class=pl-s1>self</span>.<span class=pl-s1>_driver</span>, <span class=pl-c1>10</span>).<span class=pl-en>until</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L63" class="blob-num js-line-number" data-line-number="63"></td>
        <td id="file-gym_chrome_dino_game-py-LC63" class="blob-code blob-code-inner js-file-line">            <span class=pl-v>EC</span>.<span class=pl-en>presence_of_element_located</span>((</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L64" class="blob-num js-line-number" data-line-number="64"></td>
        <td id="file-gym_chrome_dino_game-py-LC64" class="blob-code blob-code-inner js-file-line">                <span class=pl-v>By</span>.<span class=pl-v>CLASS_NAME</span>, </td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L65" class="blob-num js-line-number" data-line-number="65"></td>
        <td id="file-gym_chrome_dino_game-py-LC65" class="blob-code blob-code-inner js-file-line">                <span class=pl-s>&quot;runner-canvas&quot;</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L66" class="blob-num js-line-number" data-line-number="66"></td>
        <td id="file-gym_chrome_dino_game-py-LC66" class="blob-code blob-code-inner js-file-line">            ))</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L67" class="blob-num js-line-number" data-line-number="67"></td>
        <td id="file-gym_chrome_dino_game-py-LC67" class="blob-code blob-code-inner js-file-line">        )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L68" class="blob-num js-line-number" data-line-number="68"></td>
        <td id="file-gym_chrome_dino_game-py-LC68" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L69" class="blob-num js-line-number" data-line-number="69"></td>
        <td id="file-gym_chrome_dino_game-py-LC69" class="blob-code blob-code-inner js-file-line">        <span class=pl-c># trigger game start</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L70" class="blob-num js-line-number" data-line-number="70"></td>
        <td id="file-gym_chrome_dino_game-py-LC70" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>_driver</span>.<span class=pl-en>find_element_by_tag_name</span>(<span class=pl-s>&quot;body&quot;</span>).<span class=pl-en>send_keys</span>(<span class=pl-v>Keys</span>.<span class=pl-v>SPACE</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L71" class="blob-num js-line-number" data-line-number="71"></td>
        <td id="file-gym_chrome_dino_game-py-LC71" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L72" class="blob-num js-line-number" data-line-number="72"></td>
        <td id="file-gym_chrome_dino_game-py-LC72" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>return</span> <span class=pl-s1>self</span>.<span class=pl-en>_next_observation</span>()</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L73" class="blob-num js-line-number" data-line-number="73"></td>
        <td id="file-gym_chrome_dino_game-py-LC73" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L74" class="blob-num js-line-number" data-line-number="74"></td>
        <td id="file-gym_chrome_dino_game-py-LC74" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>def</span> <span class=pl-en>_get_image</span>(<span class=pl-s1>self</span>):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L75" class="blob-num js-line-number" data-line-number="75"></td>
        <td id="file-gym_chrome_dino_game-py-LC75" class="blob-code blob-code-inner js-file-line">        <span class=pl-v>LEADING_TEXT</span> <span class=pl-c1>=</span> <span class=pl-s>&quot;data:image/png;base64,&quot;</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L76" class="blob-num js-line-number" data-line-number="76"></td>
        <td id="file-gym_chrome_dino_game-py-LC76" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>_img</span> <span class=pl-c1>=</span> <span class=pl-s1>self</span>.<span class=pl-s1>_driver</span>.<span class=pl-en>execute_script</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L77" class="blob-num js-line-number" data-line-number="77"></td>
        <td id="file-gym_chrome_dino_game-py-LC77" class="blob-code blob-code-inner js-file-line">            <span class=pl-s>&quot;return document.querySelector(&#39;canvas.runner-canvas&#39;).toDataURL()&quot;</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L78" class="blob-num js-line-number" data-line-number="78"></td>
        <td id="file-gym_chrome_dino_game-py-LC78" class="blob-code blob-code-inner js-file-line">        )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L79" class="blob-num js-line-number" data-line-number="79"></td>
        <td id="file-gym_chrome_dino_game-py-LC79" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>_img</span> <span class=pl-c1>=</span> <span class=pl-s1>_img</span>[<span class=pl-en>len</span>(<span class=pl-v>LEADING_TEXT</span>):]</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L80" class="blob-num js-line-number" data-line-number="80"></td>
        <td id="file-gym_chrome_dino_game-py-LC80" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>return</span> <span class=pl-s1>np</span>.<span class=pl-en>array</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L81" class="blob-num js-line-number" data-line-number="81"></td>
        <td id="file-gym_chrome_dino_game-py-LC81" class="blob-code blob-code-inner js-file-line">            <span class=pl-v>Image</span>.<span class=pl-en>open</span>(<span class=pl-v>BytesIO</span>(<span class=pl-s1>base64</span>.<span class=pl-en>b64decode</span>(<span class=pl-s1>_img</span>)))</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L82" class="blob-num js-line-number" data-line-number="82"></td>
        <td id="file-gym_chrome_dino_game-py-LC82" class="blob-code blob-code-inner js-file-line">        )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L83" class="blob-num js-line-number" data-line-number="83"></td>
        <td id="file-gym_chrome_dino_game-py-LC83" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L84" class="blob-num js-line-number" data-line-number="84"></td>
        <td id="file-gym_chrome_dino_game-py-LC84" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>def</span> <span class=pl-en>_next_observation</span>(<span class=pl-s1>self</span>):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L85" class="blob-num js-line-number" data-line-number="85"></td>
        <td id="file-gym_chrome_dino_game-py-LC85" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>image</span> <span class=pl-c1>=</span> <span class=pl-s1>cv2</span>.<span class=pl-en>cvtColor</span>(<span class=pl-s1>self</span>.<span class=pl-en>_get_image</span>(), <span class=pl-s1>cv2</span>.<span class=pl-v>COLOR_BGR2GRAY</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L86" class="blob-num js-line-number" data-line-number="86"></td>
        <td id="file-gym_chrome_dino_game-py-LC86" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>image</span> <span class=pl-c1>=</span> <span class=pl-s1>image</span>[:<span class=pl-c1>500</span>, :<span class=pl-c1>480</span>] <span class=pl-c># cropping</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L87" class="blob-num js-line-number" data-line-number="87"></td>
        <td id="file-gym_chrome_dino_game-py-LC87" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>image</span> <span class=pl-c1>=</span> <span class=pl-s1>cv2</span>.<span class=pl-en>resize</span>(<span class=pl-s1>image</span>, (<span class=pl-s1>self</span>.<span class=pl-s1>screen_width</span>, <span class=pl-s1>self</span>.<span class=pl-s1>screen_height</span>))</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L88" class="blob-num js-line-number" data-line-number="88"></td>
        <td id="file-gym_chrome_dino_game-py-LC88" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L89" class="blob-num js-line-number" data-line-number="89"></td>
        <td id="file-gym_chrome_dino_game-py-LC89" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>state_queue</span>.<span class=pl-en>append</span>(<span class=pl-s1>image</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L90" class="blob-num js-line-number" data-line-number="90"></td>
        <td id="file-gym_chrome_dino_game-py-LC90" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L91" class="blob-num js-line-number" data-line-number="91"></td>
        <td id="file-gym_chrome_dino_game-py-LC91" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>if</span> <span class=pl-en>len</span>(<span class=pl-s1>self</span>.<span class=pl-s1>state_queue</span>) <span class=pl-c1>&lt;</span> <span class=pl-c1>4</span>:</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L92" class="blob-num js-line-number" data-line-number="92"></td>
        <td id="file-gym_chrome_dino_game-py-LC92" class="blob-code blob-code-inner js-file-line">            <span class=pl-k>return</span> <span class=pl-s1>np</span>.<span class=pl-en>stack</span>([<span class=pl-s1>image</span>] <span class=pl-c1>*</span> <span class=pl-c1>4</span>, <span class=pl-s1>axis</span><span class=pl-c1>=</span><span class=pl-c1>-</span><span class=pl-c1>1</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L93" class="blob-num js-line-number" data-line-number="93"></td>
        <td id="file-gym_chrome_dino_game-py-LC93" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>else</span>:</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L94" class="blob-num js-line-number" data-line-number="94"></td>
        <td id="file-gym_chrome_dino_game-py-LC94" class="blob-code blob-code-inner js-file-line">            <span class=pl-k>return</span> <span class=pl-s1>np</span>.<span class=pl-en>stack</span>(<span class=pl-s1>self</span>.<span class=pl-s1>state_queue</span>, <span class=pl-s1>axis</span><span class=pl-c1>=</span><span class=pl-c1>-</span><span class=pl-c1>1</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L95" class="blob-num js-line-number" data-line-number="95"></td>
        <td id="file-gym_chrome_dino_game-py-LC95" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L96" class="blob-num js-line-number" data-line-number="96"></td>
        <td id="file-gym_chrome_dino_game-py-LC96" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>return</span> <span class=pl-s1>image</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L97" class="blob-num js-line-number" data-line-number="97"></td>
        <td id="file-gym_chrome_dino_game-py-LC97" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L98" class="blob-num js-line-number" data-line-number="98"></td>
        <td id="file-gym_chrome_dino_game-py-LC98" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>def</span> <span class=pl-en>_get_score</span>(<span class=pl-s1>self</span>):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L99" class="blob-num js-line-number" data-line-number="99"></td>
        <td id="file-gym_chrome_dino_game-py-LC99" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>return</span> <span class=pl-en>int</span>(<span class=pl-s>&#39;&#39;</span>.<span class=pl-en>join</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L100" class="blob-num js-line-number" data-line-number="100"></td>
        <td id="file-gym_chrome_dino_game-py-LC100" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>self</span>.<span class=pl-s1>_driver</span>.<span class=pl-en>execute_script</span>(<span class=pl-s>&quot;return Runner.instance_.distanceMeter.digits&quot;</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L101" class="blob-num js-line-number" data-line-number="101"></td>
        <td id="file-gym_chrome_dino_game-py-LC101" class="blob-code blob-code-inner js-file-line">        ))</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L102" class="blob-num js-line-number" data-line-number="102"></td>
        <td id="file-gym_chrome_dino_game-py-LC102" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L103" class="blob-num js-line-number" data-line-number="103"></td>
        <td id="file-gym_chrome_dino_game-py-LC103" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>def</span> <span class=pl-en>_get_done</span>(<span class=pl-s1>self</span>):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L104" class="blob-num js-line-number" data-line-number="104"></td>
        <td id="file-gym_chrome_dino_game-py-LC104" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>return</span> <span class=pl-c1>not</span> <span class=pl-s1>self</span>.<span class=pl-s1>_driver</span>.<span class=pl-en>execute_script</span>(<span class=pl-s>&quot;return Runner.instance_.playing&quot;</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L105" class="blob-num js-line-number" data-line-number="105"></td>
        <td id="file-gym_chrome_dino_game-py-LC105" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L106" class="blob-num js-line-number" data-line-number="106"></td>
        <td id="file-gym_chrome_dino_game-py-LC106" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>def</span> <span class=pl-en>step</span>(<span class=pl-s1>self</span>, <span class=pl-s1>action</span>: <span class=pl-s1>int</span>):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L107" class="blob-num js-line-number" data-line-number="107"></td>
        <td id="file-gym_chrome_dino_game-py-LC107" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>self</span>.<span class=pl-s1>_driver</span>.<span class=pl-en>find_element_by_tag_name</span>(<span class=pl-s>&quot;body&quot;</span>) \</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L108" class="blob-num js-line-number" data-line-number="108"></td>
        <td id="file-gym_chrome_dino_game-py-LC108" class="blob-code blob-code-inner js-file-line">            .<span class=pl-en>send_keys</span>(<span class=pl-s1>self</span>.<span class=pl-s1>actions_map</span>[<span class=pl-s1>action</span>])</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L109" class="blob-num js-line-number" data-line-number="109"></td>
        <td id="file-gym_chrome_dino_game-py-LC109" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L110" class="blob-num js-line-number" data-line-number="110"></td>
        <td id="file-gym_chrome_dino_game-py-LC110" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>obs</span> <span class=pl-c1>=</span> <span class=pl-s1>self</span>.<span class=pl-en>_next_observation</span>()</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L111" class="blob-num js-line-number" data-line-number="111"></td>
        <td id="file-gym_chrome_dino_game-py-LC111" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L112" class="blob-num js-line-number" data-line-number="112"></td>
        <td id="file-gym_chrome_dino_game-py-LC112" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>done</span> <span class=pl-c1>=</span> <span class=pl-s1>self</span>.<span class=pl-en>_get_done</span>()</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L113" class="blob-num js-line-number" data-line-number="113"></td>
        <td id="file-gym_chrome_dino_game-py-LC113" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>reward</span> <span class=pl-c1>=</span> <span class=pl-c1>.1</span> <span class=pl-k>if</span> <span class=pl-c1>not</span> <span class=pl-s1>done</span> <span class=pl-k>else</span> <span class=pl-c1>-</span><span class=pl-c1>1</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L114" class="blob-num js-line-number" data-line-number="114"></td>
        <td id="file-gym_chrome_dino_game-py-LC114" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L115" class="blob-num js-line-number" data-line-number="115"></td>
        <td id="file-gym_chrome_dino_game-py-LC115" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>time</span>.<span class=pl-en>sleep</span>(<span class=pl-c1>.015</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L116" class="blob-num js-line-number" data-line-number="116"></td>
        <td id="file-gym_chrome_dino_game-py-LC116" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L117" class="blob-num js-line-number" data-line-number="117"></td>
        <td id="file-gym_chrome_dino_game-py-LC117" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>return</span> <span class=pl-s1>obs</span>, <span class=pl-s1>reward</span>, <span class=pl-s1>done</span>, {<span class=pl-s>&quot;score&quot;</span>: <span class=pl-s1>self</span>.<span class=pl-en>_get_score</span>()}</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L118" class="blob-num js-line-number" data-line-number="118"></td>
        <td id="file-gym_chrome_dino_game-py-LC118" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L119" class="blob-num js-line-number" data-line-number="119"></td>
        <td id="file-gym_chrome_dino_game-py-LC119" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>def</span> <span class=pl-en>render</span>(<span class=pl-s1>self</span>, <span class=pl-s1>mode</span>: <span class=pl-s1>str</span><span class=pl-c1>=</span><span class=pl-s>&#39;human&#39;</span>):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L120" class="blob-num js-line-number" data-line-number="120"></td>
        <td id="file-gym_chrome_dino_game-py-LC120" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>img</span> <span class=pl-c1>=</span> <span class=pl-s1>cv2</span>.<span class=pl-en>cvtColor</span>(<span class=pl-s1>self</span>.<span class=pl-en>_get_image</span>(), <span class=pl-s1>cv2</span>.<span class=pl-v>COLOR_BGR2RGB</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L121" class="blob-num js-line-number" data-line-number="121"></td>
        <td id="file-gym_chrome_dino_game-py-LC121" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>if</span> <span class=pl-s1>mode</span> <span class=pl-c1>==</span> <span class=pl-s>&#39;rgb_array&#39;</span>:</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L122" class="blob-num js-line-number" data-line-number="122"></td>
        <td id="file-gym_chrome_dino_game-py-LC122" class="blob-code blob-code-inner js-file-line">            <span class=pl-k>return</span> <span class=pl-s1>img</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L123" class="blob-num js-line-number" data-line-number="123"></td>
        <td id="file-gym_chrome_dino_game-py-LC123" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>elif</span> <span class=pl-s1>mode</span> <span class=pl-c1>==</span> <span class=pl-s>&#39;human&#39;</span>:</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L124" class="blob-num js-line-number" data-line-number="124"></td>
        <td id="file-gym_chrome_dino_game-py-LC124" class="blob-code blob-code-inner js-file-line">            <span class=pl-k>from</span> <span class=pl-s1>gym</span>.<span class=pl-s1>envs</span>.<span class=pl-s1>classic_control</span> <span class=pl-k>import</span> <span class=pl-s1>rendering</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L125" class="blob-num js-line-number" data-line-number="125"></td>
        <td id="file-gym_chrome_dino_game-py-LC125" class="blob-code blob-code-inner js-file-line">            <span class=pl-k>if</span> <span class=pl-s1>self</span>.<span class=pl-s1>viewer</span> <span class=pl-c1>is</span> <span class=pl-c1>None</span>:</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L126" class="blob-num js-line-number" data-line-number="126"></td>
        <td id="file-gym_chrome_dino_game-py-LC126" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>self</span>.<span class=pl-s1>viewer</span> <span class=pl-c1>=</span> <span class=pl-s1>rendering</span>.<span class=pl-v>SimpleImageViewer</span>()</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L127" class="blob-num js-line-number" data-line-number="127"></td>
        <td id="file-gym_chrome_dino_game-py-LC127" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>self</span>.<span class=pl-s1>viewer</span>.<span class=pl-en>imshow</span>(<span class=pl-s1>img</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L128" class="blob-num js-line-number" data-line-number="128"></td>
        <td id="file-gym_chrome_dino_game-py-LC128" class="blob-code blob-code-inner js-file-line">            <span class=pl-k>return</span> <span class=pl-s1>self</span>.<span class=pl-s1>viewer</span>.<span class=pl-s1>isopen</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L129" class="blob-num js-line-number" data-line-number="129"></td>
        <td id="file-gym_chrome_dino_game-py-LC129" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L130" class="blob-num js-line-number" data-line-number="130"></td>
        <td id="file-gym_chrome_dino_game-py-LC130" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>def</span> <span class=pl-en>close</span>(<span class=pl-s1>self</span>):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L131" class="blob-num js-line-number" data-line-number="131"></td>
        <td id="file-gym_chrome_dino_game-py-LC131" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>if</span> <span class=pl-s1>self</span>.<span class=pl-s1>viewer</span> <span class=pl-c1>is</span> <span class=pl-c1>not</span> <span class=pl-c1>None</span>:</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L132" class="blob-num js-line-number" data-line-number="132"></td>
        <td id="file-gym_chrome_dino_game-py-LC132" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>self</span>.<span class=pl-s1>viewer</span>.<span class=pl-en>close</span>()</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L133" class="blob-num js-line-number" data-line-number="133"></td>
        <td id="file-gym_chrome_dino_game-py-LC133" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>self</span>.<span class=pl-s1>viewer</span> <span class=pl-c1>=</span> <span class=pl-c1>None</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L134" class="blob-num js-line-number" data-line-number="134"></td>
        <td id="file-gym_chrome_dino_game-py-LC134" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L135" class="blob-num js-line-number" data-line-number="135"></td>
        <td id="file-gym_chrome_dino_game-py-LC135" class="blob-code blob-code-inner js-file-line"><span class=pl-k>import</span> <span class=pl-s1>imageio</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L136" class="blob-num js-line-number" data-line-number="136"></td>
        <td id="file-gym_chrome_dino_game-py-LC136" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L137" class="blob-num js-line-number" data-line-number="137"></td>
        <td id="file-gym_chrome_dino_game-py-LC137" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>tqdm</span> <span class=pl-k>import</span> <span class=pl-s1>tqdm</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L138" class="blob-num js-line-number" data-line-number="138"></td>
        <td id="file-gym_chrome_dino_game-py-LC138" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L139" class="blob-num js-line-number" data-line-number="139"></td>
        <td id="file-gym_chrome_dino_game-py-LC139" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>stable_baselines</span> <span class=pl-k>import</span> <span class=pl-v>PPO2</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L140" class="blob-num js-line-number" data-line-number="140"></td>
        <td id="file-gym_chrome_dino_game-py-LC140" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>stable_baselines</span>.<span class=pl-s1>common</span>.<span class=pl-s1>policies</span> <span class=pl-k>import</span> <span class=pl-v>CnnPolicy</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L141" class="blob-num js-line-number" data-line-number="141"></td>
        <td id="file-gym_chrome_dino_game-py-LC141" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>stable_baselines</span>.<span class=pl-s1>common</span>.<span class=pl-s1>vec_env</span> <span class=pl-k>import</span> <span class=pl-v>SubprocVecEnv</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L142" class="blob-num js-line-number" data-line-number="142"></td>
        <td id="file-gym_chrome_dino_game-py-LC142" class="blob-code blob-code-inner js-file-line"><span class=pl-k>from</span> <span class=pl-s1>stable_baselines</span>.<span class=pl-s1>common</span>.<span class=pl-s1>callbacks</span> <span class=pl-k>import</span> <span class=pl-v>CheckpointCallback</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L143" class="blob-num js-line-number" data-line-number="143"></td>
        <td id="file-gym_chrome_dino_game-py-LC143" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L144" class="blob-num js-line-number" data-line-number="144"></td>
        <td id="file-gym_chrome_dino_game-py-LC144" class="blob-code blob-code-inner js-file-line"><span class=pl-k>if</span> <span class=pl-s1>__name__</span> <span class=pl-c1>==</span> <span class=pl-s>&#39;__main__&#39;</span>:</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L145" class="blob-num js-line-number" data-line-number="145"></td>
        <td id="file-gym_chrome_dino_game-py-LC145" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>env_lambda</span> <span class=pl-c1>=</span> <span class=pl-k>lambda</span>: <span class=pl-v>ChromeDinoEnv</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L146" class="blob-num js-line-number" data-line-number="146"></td>
        <td id="file-gym_chrome_dino_game-py-LC146" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>screen_width</span><span class=pl-c1>=</span><span class=pl-c1>96</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L147" class="blob-num js-line-number" data-line-number="147"></td>
        <td id="file-gym_chrome_dino_game-py-LC147" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>screen_height</span><span class=pl-c1>=</span><span class=pl-c1>96</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L148" class="blob-num js-line-number" data-line-number="148"></td>
        <td id="file-gym_chrome_dino_game-py-LC148" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>chromedriver_path</span><span class=pl-c1>=</span><span class=pl-s1>os</span>.<span class=pl-s1>path</span>.<span class=pl-en>join</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L149" class="blob-num js-line-number" data-line-number="149"></td>
        <td id="file-gym_chrome_dino_game-py-LC149" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>os</span>.<span class=pl-s1>path</span>.<span class=pl-en>dirname</span>(<span class=pl-s1>os</span>.<span class=pl-s1>path</span>.<span class=pl-en>abspath</span>(<span class=pl-s1>__file__</span>)),</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L150" class="blob-num js-line-number" data-line-number="150"></td>
        <td id="file-gym_chrome_dino_game-py-LC150" class="blob-code blob-code-inner js-file-line">            <span class=pl-s>&quot;chromedriver&quot;</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L151" class="blob-num js-line-number" data-line-number="151"></td>
        <td id="file-gym_chrome_dino_game-py-LC151" class="blob-code blob-code-inner js-file-line">        )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L152" class="blob-num js-line-number" data-line-number="152"></td>
        <td id="file-gym_chrome_dino_game-py-LC152" class="blob-code blob-code-inner js-file-line">    )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L153" class="blob-num js-line-number" data-line-number="153"></td>
        <td id="file-gym_chrome_dino_game-py-LC153" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>do_train</span> <span class=pl-c1>=</span> <span class=pl-c1>False</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L154" class="blob-num js-line-number" data-line-number="154"></td>
        <td id="file-gym_chrome_dino_game-py-LC154" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>num_cpu</span> <span class=pl-c1>=</span> <span class=pl-c1>4</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L155" class="blob-num js-line-number" data-line-number="155"></td>
        <td id="file-gym_chrome_dino_game-py-LC155" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>save_path</span> <span class=pl-c1>=</span> <span class=pl-s>&quot;chrome_dino_ppo_cnn&quot;</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L156" class="blob-num js-line-number" data-line-number="156"></td>
        <td id="file-gym_chrome_dino_game-py-LC156" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>env</span> <span class=pl-c1>=</span> <span class=pl-v>SubprocVecEnv</span>([<span class=pl-s1>env_lambda</span> <span class=pl-k>for</span> <span class=pl-s1>i</span> <span class=pl-c1>in</span> <span class=pl-en>range</span>(<span class=pl-s1>num_cpu</span>)])</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L157" class="blob-num js-line-number" data-line-number="157"></td>
        <td id="file-gym_chrome_dino_game-py-LC157" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L158" class="blob-num js-line-number" data-line-number="158"></td>
        <td id="file-gym_chrome_dino_game-py-LC158" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>if</span> <span class=pl-s1>do_train</span>:</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L159" class="blob-num js-line-number" data-line-number="159"></td>
        <td id="file-gym_chrome_dino_game-py-LC159" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>checkpoint_callback</span> <span class=pl-c1>=</span> <span class=pl-v>CheckpointCallback</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L160" class="blob-num js-line-number" data-line-number="160"></td>
        <td id="file-gym_chrome_dino_game-py-LC160" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>save_freq</span><span class=pl-c1>=</span><span class=pl-c1>200000</span>, </td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L161" class="blob-num js-line-number" data-line-number="161"></td>
        <td id="file-gym_chrome_dino_game-py-LC161" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>save_path</span><span class=pl-c1>=</span><span class=pl-s>&#39;./.checkpoints/&#39;</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L162" class="blob-num js-line-number" data-line-number="162"></td>
        <td id="file-gym_chrome_dino_game-py-LC162" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>name_prefix</span><span class=pl-c1>=</span><span class=pl-s1>save_path</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L163" class="blob-num js-line-number" data-line-number="163"></td>
        <td id="file-gym_chrome_dino_game-py-LC163" class="blob-code blob-code-inner js-file-line">        )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L164" class="blob-num js-line-number" data-line-number="164"></td>
        <td id="file-gym_chrome_dino_game-py-LC164" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>model</span> <span class=pl-c1>=</span> <span class=pl-v>PPO2</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L165" class="blob-num js-line-number" data-line-number="165"></td>
        <td id="file-gym_chrome_dino_game-py-LC165" class="blob-code blob-code-inner js-file-line">            <span class=pl-v>CnnPolicy</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L166" class="blob-num js-line-number" data-line-number="166"></td>
        <td id="file-gym_chrome_dino_game-py-LC166" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>env</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L167" class="blob-num js-line-number" data-line-number="167"></td>
        <td id="file-gym_chrome_dino_game-py-LC167" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>verbose</span><span class=pl-c1>=</span><span class=pl-c1>1</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L168" class="blob-num js-line-number" data-line-number="168"></td>
        <td id="file-gym_chrome_dino_game-py-LC168" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>tensorboard_log</span><span class=pl-c1>=</span><span class=pl-s>&quot;./.tb_chromedino_env/&quot;</span>,</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L169" class="blob-num js-line-number" data-line-number="169"></td>
        <td id="file-gym_chrome_dino_game-py-LC169" class="blob-code blob-code-inner js-file-line">        )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L170" class="blob-num js-line-number" data-line-number="170"></td>
        <td id="file-gym_chrome_dino_game-py-LC170" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>model</span>.<span class=pl-en>learn</span>(</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L171" class="blob-num js-line-number" data-line-number="171"></td>
        <td id="file-gym_chrome_dino_game-py-LC171" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>total_timesteps</span><span class=pl-c1>=</span><span class=pl-c1>2000000</span>, </td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L172" class="blob-num js-line-number" data-line-number="172"></td>
        <td id="file-gym_chrome_dino_game-py-LC172" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>callback</span><span class=pl-c1>=</span>[<span class=pl-s1>checkpoint_callback</span>]</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L173" class="blob-num js-line-number" data-line-number="173"></td>
        <td id="file-gym_chrome_dino_game-py-LC173" class="blob-code blob-code-inner js-file-line">        )</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L174" class="blob-num js-line-number" data-line-number="174"></td>
        <td id="file-gym_chrome_dino_game-py-LC174" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>model</span>.<span class=pl-en>save</span>(<span class=pl-s1>save_path</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L175" class="blob-num js-line-number" data-line-number="175"></td>
        <td id="file-gym_chrome_dino_game-py-LC175" class="blob-code blob-code-inner js-file-line">    </td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L176" class="blob-num js-line-number" data-line-number="176"></td>
        <td id="file-gym_chrome_dino_game-py-LC176" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>model</span> <span class=pl-c1>=</span> <span class=pl-v>PPO2</span>.<span class=pl-en>load</span>(<span class=pl-s1>save_path</span>, <span class=pl-s1>env</span><span class=pl-c1>=</span><span class=pl-s1>env</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L177" class="blob-num js-line-number" data-line-number="177"></td>
        <td id="file-gym_chrome_dino_game-py-LC177" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L178" class="blob-num js-line-number" data-line-number="178"></td>
        <td id="file-gym_chrome_dino_game-py-LC178" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>images</span> <span class=pl-c1>=</span> []</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L179" class="blob-num js-line-number" data-line-number="179"></td>
        <td id="file-gym_chrome_dino_game-py-LC179" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L180" class="blob-num js-line-number" data-line-number="180"></td>
        <td id="file-gym_chrome_dino_game-py-LC180" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>obs</span> <span class=pl-c1>=</span> <span class=pl-s1>env</span>.<span class=pl-en>reset</span>()</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L181" class="blob-num js-line-number" data-line-number="181"></td>
        <td id="file-gym_chrome_dino_game-py-LC181" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>img</span> <span class=pl-c1>=</span> <span class=pl-s1>model</span>.<span class=pl-s1>env</span>.<span class=pl-en>render</span>(<span class=pl-s1>mode</span><span class=pl-c1>=</span><span class=pl-s>&#39;rgb_array&#39;</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L182" class="blob-num js-line-number" data-line-number="182"></td>
        <td id="file-gym_chrome_dino_game-py-LC182" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L183" class="blob-num js-line-number" data-line-number="183"></td>
        <td id="file-gym_chrome_dino_game-py-LC183" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>for</span> <span class=pl-s1>i</span> <span class=pl-c1>in</span> <span class=pl-en>tqdm</span>(<span class=pl-en>range</span>(<span class=pl-c1>500</span>)):</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L184" class="blob-num js-line-number" data-line-number="184"></td>
        <td id="file-gym_chrome_dino_game-py-LC184" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>images</span>.<span class=pl-en>append</span>(<span class=pl-s1>img</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L185" class="blob-num js-line-number" data-line-number="185"></td>
        <td id="file-gym_chrome_dino_game-py-LC185" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>action</span>, <span class=pl-s1>_states</span> <span class=pl-c1>=</span> <span class=pl-s1>model</span>.<span class=pl-en>predict</span>(<span class=pl-s1>obs</span>, <span class=pl-s1>deterministic</span><span class=pl-c1>=</span><span class=pl-c1>True</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L186" class="blob-num js-line-number" data-line-number="186"></td>
        <td id="file-gym_chrome_dino_game-py-LC186" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>obs</span>, <span class=pl-s1>rewards</span>, <span class=pl-s1>dones</span>, <span class=pl-s1>info</span> <span class=pl-c1>=</span> <span class=pl-s1>env</span>.<span class=pl-en>step</span>(<span class=pl-s1>action</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L187" class="blob-num js-line-number" data-line-number="187"></td>
        <td id="file-gym_chrome_dino_game-py-LC187" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L188" class="blob-num js-line-number" data-line-number="188"></td>
        <td id="file-gym_chrome_dino_game-py-LC188" class="blob-code blob-code-inner js-file-line">        <span class=pl-c># env.render(mode=&#39;human&#39;)</span></td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L189" class="blob-num js-line-number" data-line-number="189"></td>
        <td id="file-gym_chrome_dino_game-py-LC189" class="blob-code blob-code-inner js-file-line">        </td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L190" class="blob-num js-line-number" data-line-number="190"></td>
        <td id="file-gym_chrome_dino_game-py-LC190" class="blob-code blob-code-inner js-file-line">        <span class=pl-s1>img</span> <span class=pl-c1>=</span> <span class=pl-s1>env</span>.<span class=pl-en>render</span>(<span class=pl-s1>mode</span><span class=pl-c1>=</span><span class=pl-s>&#39;rgb_array&#39;</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L191" class="blob-num js-line-number" data-line-number="191"></td>
        <td id="file-gym_chrome_dino_game-py-LC191" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L192" class="blob-num js-line-number" data-line-number="192"></td>
        <td id="file-gym_chrome_dino_game-py-LC192" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>imageio</span>.<span class=pl-en>mimsave</span>(<span class=pl-s>&#39;dino.gif&#39;</span>, [<span class=pl-s1>np</span>.<span class=pl-en>array</span>(<span class=pl-s1>img</span>) <span class=pl-k>for</span> <span class=pl-s1>i</span>, <span class=pl-s1>img</span> <span class=pl-c1>in</span> <span class=pl-en>enumerate</span>(<span class=pl-s1>images</span>)], <span class=pl-s1>fps</span><span class=pl-c1>=</span><span class=pl-c1>15</span>)</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L193" class="blob-num js-line-number" data-line-number="193"></td>
        <td id="file-gym_chrome_dino_game-py-LC193" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-gym_chrome_dino_game-py-L194" class="blob-num js-line-number" data-line-number="194"></td>
        <td id="file-gym_chrome_dino_game-py-LC194" class="blob-code blob-code-inner js-file-line">    <span class=pl-en>exit</span>()</td>
      </tr>
</table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/luungoc2005/979c279effc9a2bd3de78ea57613a36f/raw/70eaa555b64da708f88c6c2177e15477b84a7057/gym_chrome_dino_game.py" style="float:right">view raw</a>
        <a href="https://gist.github.com/luungoc2005/979c279effc9a2bd3de78ea57613a36f#file-gym_chrome_dino_game-py">gym_chrome_dino_game.py</a>
        hosted with &#10084; by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div></p>
<p>Further Reading:</p>
<ul>
<li>DQN paper: <a href="https://arxiv.org/abs/1312.5602">https://arxiv.org/abs/1312.5602</a></li>
<li><code class="language-text">stable-baselines</code> documentation: <a href="https://stable-baselines.readthedocs.io/">https://stable-baselines.readthedocs.io/</a></li>
</ul></article><section><div shortname="luungoc2005" config="[object Object]" id="disqus_thread"></div></section></section></div></div><div class="Footer--footer--3N4oY"><section class="Container--container--3QHbe"><div class="Footer--footer__content--3FUJz"><a href="https://luungoc2005.github.io" target="_blank" rel="noopener noreferrer"></a><ul class="Footer--footer__list--3m4JX"><li class="Footer--footer__item--31NlX"><a alt="Twitter" href="https://twitter.com/luungoc2005" target="_blank" rel="noopener noreferrer"><svg width="20px" height="15px" viewBox="0 0 20 15" version="1.1"><title>Twitter</title><defs></defs><g id="Good-One" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Footer_06" transform="translate(-1091.000000, -3948.000000)" fill="#9EA0A6"><g id="Group-7" transform="translate(0.000000, 3204.000000)"><g id="Group-6" transform="translate(75.000000, 733.000000)"><g id="dribbble" transform="translate(976.000000, 9.000000)"><path d="M53.2813915,2 C51.0959361,2 49.3247358,3.69382235 49.3247358,5.78774534 C49.3247358,6.08310267 49.3596502,6.37374182 49.4275918,6.64928284 C46.1380851,6.48980876 43.2222572,4.98471314 41.2708228,2.68885254 C40.9301711,3.25031454 40.7357826,3.90142174 40.7357826,4.59593608 C40.7357826,5.91041772 41.4331278,7.07014343 42.4956593,7.74672874 C41.8464394,7.72974333 41.236852,7.55800201 40.7027554,7.27396829 C40.7027554,7.29001007 40.7027554,7.30605184 40.7027554,7.32303724 C40.7027554,9.157461 42.066306,10.6880347 43.8771389,11.0362355 C43.5449799,11.1221062 43.1958354,11.1692879 42.8344238,11.1692879 C42.5796427,11.1692879 42.331467,11.1447534 42.0898968,11.1032335 C42.5937972,12.603611 44.0554857,13.7038878 45.7870533,13.7331404 C44.4319955,14.7447157 42.7259059,15.3552466 40.8726095,15.3552466 C40.5527177,15.3552466 40.237544,15.3344867 39.9280322,15.3014595 C41.6794162,16.3753145 43.7591847,17 45.9937091,17 C53.2719552,17 57.2522018,11.2287368 57.2522018,6.22464771 C57.2522018,6.06328636 57.2484273,5.89720684 57.2408782,5.73490186 C58.0146578,5.20080523 58.6855813,4.53648717 59.2159034,3.7768621 C58.5062909,4.07505033 57.7438349,4.27887519 56.9436336,4.37135128 C57.7598767,3.90142174 58.3873931,3.16066935 58.6827504,2.27648465 C57.9184071,2.70961248 57.0710242,3.02478611 56.1707977,3.19369653 C55.4479743,2.45954957 54.4203573,2 53.2813915,2" id="Fill-1"></path></g></g></g></g></g></svg></a></li><li class="Footer--footer__item--31NlX"><a alt="Github" href="https://github.com/luungoc2005" target="_blank" rel="noopener noreferrer"><svg height="17" viewBox="0 0 18 17" width="18"><title>Github</title><path d="m195.711029 1c-4.810968 0-8.711029 3.90006063-8.711029 8.71102924 0 3.85027496 2.500065 7.11691086 5.958344 8.27547776.435551.0696883.574928-.2003537.574928-.4355514 0-.2003537 0-.7491486 0-1.472164-2.412955.5226618-2.926906-1.1672779-2.926906-1.1672779-.400707-1.0104794-.966924-1.2805213-.966924-1.2805213-.792704-.5400838.060977-.5226618.060977-.5226618.871103.0609772 1.332788.8972361 1.332788.8972361.757859 1.3240764 2.03838.9320801 2.534909.7230154.078399-.5662169.304886-.9495022.548795-1.1672779-1.933849-.2177758-3.963518-.9669243-3.963518-4.28582642 0-.96692425.331019-1.74220585.897236-2.36068893-.087111-.21777573-.391997-1.12372277.08711-2.29971172 0 0 .731726-.23519779 2.395533.88852499.688171-.19164265 1.43732-.28746397 2.177757-.28746397.740438 0 1.489586.09582132 2.177758.28746397 1.663806-1.12372278 2.395533-.88852499 2.395533-.88852499.479106 1.17598895.17422 2.08193599.08711 2.29971172.566217.61848308.897236 1.39376468.897236 2.36068893 0 3.32761312-2.038381 4.05933962-3.98094 4.27711532.313597.2700419.601061.8014147.601061 1.6115404v2.3868221c0 .2351977.139376.5139507.583639.4355514 3.458278-1.1672779 5.949632-4.4252028 5.949632-8.27547776 0-2.3103086-.917766-4.52599297-2.551401-6.15962785-1.633635-1.63363487-3.849319-2.55140139-6.159628-2.55140139z" fill="#9ea0a6" transform="translate(-187 -1)"></path></svg></a></li><li class="Footer--footer__item--31NlX"><a alt="Facebook" href="https://www.facebook.com/luungoc2005" target="_blank" rel="noopener noreferrer"><svg width="9px" height="18px" viewBox="0 0 9 18" version="1.1"><title>Facebook</title><defs></defs><g id="Good-One" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Footer_06" transform="translate(-1051.000000, -3946.000000)" fill="#9EA0A6" fill-rule="nonzero"><g id="Group-7" transform="translate(0.000000, 3204.000000)"><g id="Group-6" transform="translate(75.000000, 733.000000)"><g id="dribbble" transform="translate(976.000000, 9.000000)"><path d="M9,0 L9,3.6 L7.2,3.6 C6.579,3.6 6.3,4.329 6.3,4.95 L6.3,7.2 L9,7.2 L9,10.8 L6.3,10.8 L6.3,18 L2.7,18 L2.7,10.8 L0,10.8 L0,7.2 L2.7,7.2 L2.7,3.6 C2.7,1.6117749 4.3117749,3.99680289e-16 6.3,0 L9,0 Z" id="Shape"></path></g></g></g></g></g></svg></a></li><li class="Footer--footer__item--31NlX"><a alt="LinkedIn" href="https://www.linkedin.com/in/luungoc2005/" target="_blank" rel="noopener noreferrer"><svg width="18" height="18" viewBox="0 0 18 18"><title>
    LinkedIn
  </title><path fill="#9EA0A6" fill-rule="nonzero" d="M18 18h-4v-6.75c0-1.06-1.19-1.94-2.25-1.94S10 10.19 10 11.25V18H6V6h4v2c.66-1.07 2.36-1.76 3.5-1.76 2.5 0 4.5 2.04 4.5 4.51V18zM4 18H0V6h4v12zM2 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path></svg></a></li></ul></div></section></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-87659525-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2020-06-15-chrome-dino-game-reinforcement-learning/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-6e8601cb757d9798e889.js"],"component---src-components-blog-post-blog-post-tsx":["/component---src-components-blog-post-blog-post-tsx-47ff1ab6a59cdc040003.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-925e542d3602a43354d0.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-2843051a8f5aed5db540.js"],"component---src-pages-blog-tsx":["/component---src-pages-blog-tsx-619e41220d75c9aaf86c.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-60a351ec886ef64c5d32.js"]};/*]]>*/</script><script src="/component---src-components-blog-post-blog-post-tsx-47ff1ab6a59cdc040003.js" async=""></script><script src="/styles-8636a280cbc61d53ad10.js" async=""></script><script src="/app-6e8601cb757d9798e889.js" async=""></script><script src="/framework-5dd3c501fd049989ea3a.js" async=""></script><script src="/webpack-runtime-40d8356165c52017e040.js" async=""></script></body></html>